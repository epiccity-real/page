<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bohncity Schule - Klasse 5</title>
    <style>
        /* Grundlegende Stildefinitionen */
        :root {
            --background-light: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --background-dark: linear-gradient(135deg, #2d3436 0%, #000000 100%);
            --text-color-light: #333;
            --text-color-dark: #f0f0f0;
            --card-background-light: white;
            --card-background-dark: #3a3a3a;
            --header-background-light: rgba(255, 255, 255, 0.95);
            --header-background-dark: rgba(25, 25, 25, 0.95);
            --nav-button-color-light: #718096;
            --nav-button-color-dark: #bbbbbb;
            --nav-button-hover-bg-light: #edf2f7;
            --nav-button-hover-bg-dark: #555;
            --nav-button-active-bg-light: linear-gradient(45deg, #667eea, #764ba2);
            --nav-button-active-bg-dark: linear-gradient(45deg, #4a5568, #2d3748);
            --subject-card-border-light: #e2e8f0;
            --subject-card-border-dark: #555;
            --topic-card-bg-light: #f7fafc;
            --topic-card-bg-dark: #444;
            --topic-card-border-light: #e2e8f0;
            --topic-card-border-dark: #666;
            --input-border-light: #e2e8f0;
            --input-border-dark: #666;
            --input-focus-shadow-light: rgba(102, 126, 234, 0.1);
            --input-focus-shadow-dark: rgba(100, 100, 200, 0.3);
            --feedback-correct-bg-light: #c6f6d5;
            --feedback-correct-bg-dark: #2f855a;
            --feedback-correct-color-light: #22543d;
            --feedback-correct-color-dark: #c6f6d5;
            --feedback-correct-border-light: #68d391;
            --feedback-correct-border-dark: #38a169;
            --feedback-incorrect-bg-light: #fed7d7;
            --feedback-incorrect-bg-dark: #c53030;
            --feedback-incorrect-color-light: #742a2a;
            --feedback-incorrect-color-dark: #fed7d7;
            --feedback-incorrect-border-light: #fc8181;
            --feedback-incorrect-border-dark: #e53e3e;
            --game-stats-bg-light: #f7fafc;
            --game-stats-bg-dark: #444;
            --game-stat-label-color-light: #718096;
            --game-stat-label-color-dark: #bbb;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: var(--background-light);
            min-height: 100vh;
            color: var(--text-color-light);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            transition: background 0.5s ease, color 0.5s ease;
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background: var(--background-dark);
            color: var(--text-color-dark);
        }

        body.dark-mode .header,
        body.dark-mode .navigation,
        body.dark-mode .topic-view,
        body.dark-mode .quiz-container,
        body.dark-mode .worksheets-container,
        body.dark-mode .quiz-end-screen {
            background: var(--header-background-dark);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        body.dark-mode .header h1,
        body.dark-mode .subject-title,
        body.dark-mode .topic-card h3,
        body.dark-mode .quiz-end-screen h2,
        body.dark-mode .worksheets-container h2,
        body.dark-mode .worksheet-card h3 {
            color: var(--text-color-dark);
        }

        body.dark-mode .stat-item,
        body.dark-mode .subject-card {
            background: var(--card-background-dark);
            color: var(--text-color-dark);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }

        body.dark-mode .stat-item {
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        body.dark-mode .nav-button {
            color: var(--nav-button-color-dark);
        }

        body.dark-mode .nav-button:hover {
            color: var(--text-color-dark);
            background: var(--nav-button-hover-bg-dark);
        }

        body.dark-mode .nav-button.active {
            background: var(--nav-button-active-bg-dark);
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        body.dark-mode .subject-description,
        body.dark-mode .topic-card p,
        body.dark-mode .quiz-end-screen p,
        body.dark-mode .quiz-progress,
        body.dark-mode .game-stat-label,
        body.dark-mode .worksheets-container p,
        body.dark-mode .worksheet-card p {
            color: var(--nav-button-color-dark);
        }

        body.dark-mode .btn {
            background: linear-gradient(45deg, #4a5568, #2d3748);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        body.dark-mode .btn:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        }

        body.dark-mode .back-btn {
            background: #4a5568;
        }

        body.dark-mode .back-btn:hover {
            background: #2d3748;
        }

        body.dark-mode .topic-card {
            background: var(--topic-card-bg-dark);
            border: 2px solid var(--topic-card-border-dark);
        }

        body.dark-mode .topic-card:hover {
            border-color: #667eea; /* Can remain bright for highlight */
            background: #555;
        }

        body.dark-mode .question-card,
        body.dark-mode .game-stats,
        body.dark-mode .worksheet-card {
            background: var(--game-stats-bg-dark);
            border: 2px solid var(--topic-card-border-dark);
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.15);
        }

        body.dark-mode .worksheet-card:hover {
            border-color: #667eea;
            background: #555;
        }

        body.dark-mode .answer-input {
            background: #555;
            color: var(--text-color-dark);
            border: 2px solid var(--input-border-dark);
        }

        body.dark-mode .answer-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px var(--input-focus-shadow-dark);
        }

        body.dark-mode .feedback.correct {
            background: var(--feedback-correct-bg-dark);
            color: var(--feedback-correct-color-dark);
            border: 2px solid var(--feedback-correct-border-dark);
        }

        body.dark-mode .feedback.incorrect {
            background: var(--feedback-incorrect-bg-dark);
            color: var(--feedback-incorrect-color-dark);
            border: 2px solid var(--feedback-incorrect-border-dark);
        }


        /* Standard-Stile (beibehalten) */
        .container {
            max-width: 1200px;
            margin: auto;
            padding: 20px;
            width: 100%;
        }

        /* Header Bereich */
        .header {
            background: var(--header-background-light);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2d3748;
            margin-bottom: 10px;
            transition: color 0.5s ease;
        }

        .bean-logo {
            font-size: 3rem;
            margin-bottom: 10px;
            display: inline-block;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            transition: background 0.5s ease, box-shadow 0.5s ease, color 0.5s ease;
        }

        /* Navigationsleiste */
        .navigation {
            background: var(--header-background-light);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 30px;
            padding: 10px 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .nav-button {
            background: none;
            border: none;
            padding: 10px 20px;
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--nav-button-color-light);
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 15px;
        }

        .nav-button:hover {
            color: #4a5568;
            background: var(--nav-button-hover-bg-light);
        }

        .nav-button.active {
            background: var(--nav-button-active-bg-light);
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        /* F√§cher√ºbersicht (Grid) */
        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .subject-card {
            background: var(--card-background-light);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 5px solid;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        /* Fachspezifische Randfarben */
        .subject-card.math { border-left-color: #3182ce; }
        .subject-card.german { border-left-color: #38a169; }
        .subject-card.english { border-left-color: #e53e3e; }
        .subject-card.science { border-left-color: #805ad5; }
        .subject-card.geography { border-left-color: #319795; }
        .subject-card.history { border-left-color: #d69e2e; }

        .subject-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .subject-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .subject-description {
            color: #718096;
            margin-bottom: 20px;
            line-height: 1.5;
            flex-grow: 1;
        }

        /* Allgemeine Button-Stile */
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Ansichten (Fach, Quiz, Arbeitsbl√§tter) */
        .topic-view, .quiz-container, .worksheets-container {
            background: var(--card-background-light);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .back-btn {
            background: #718096;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.3s ease;
        }

        .back-btn:hover {
            background: #4a5568;
        }

        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .topic-card {
            background: var(--topic-card-bg-light);
            border: 2px solid var(--topic-card-border-light);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .topic-card:hover {
            border-color: #667eea;
            background: #edf2f7;
            transform: translateY(-2px);
        }

        .topic-card h3 {
            font-size: 1.2rem;
            margin-bottom: 5px;
            color: #2d3748;
        }

        .topic-card p {
            font-size: 0.9rem;
            color: #718096;
        }

        /* Quiz Ansicht */
        .quiz-container {
            text-align: center;
        }

        .quiz-progress {
            font-size: 0.95rem;
            color: #718096;
            margin-bottom: 15px;
            text-align: left;
            padding-left: 10px;
        }

        .question-card {
            background: var(--topic-card-bg-light);
            border-radius: 15px;
            padding: 25px;
            margin: 20px auto;
            font-size: 1.3rem;
            line-height: 1.6;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: background 0.5s ease, border-color 0.5s ease;
        }

        .answer-input {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            border: 2px solid var(--input-border-light);
            border-radius: 10px;
            font-size: 1.1rem;
            margin: 20px auto;
            text-align: center;
            display: block;
            background: var(--card-background-light);
            color: var(--text-color-light);
            transition: background 0.5s ease, border-color 0.5s ease, color 0.5s ease;
        }

        .answer-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px var(--input-focus-shadow-light);
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 20px auto;
            font-weight: bold;
            max-width: 400px;
            text-align: center;
            transition: all 0.3s ease-out;
            opacity: 0;
            transform: translateY(10px);
            font-size: 1rem;
        }

        .feedback.show {
            opacity: 1;
            transform: translateY(0);
        }

        .feedback.correct {
            background: var(--feedback-correct-bg-light);
            color: var(--feedback-correct-color-light);
            border: 2px solid var(--feedback-correct-border-light);
        }

        .feedback.incorrect {
            background: var(--feedback-incorrect-bg-light);
            color: var(--feedback-incorrect-color-light);
            border: 2px solid var(--feedback-incorrect-border-light);
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            background: var(--game-stats-bg-light);
            padding: 15px;
            border-radius: 15px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
            flex-wrap: wrap;
            gap: 10px;
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .game-stat {
            text-align: center;
            padding: 5px 10px;
        }

        .game-stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea; /* This color often stays the same for highlights */
        }

        .game-stat-label {
            color: var(--game-stat-label-color-light);
            font-size: 0.9rem;
        }

        /* Hilfsklassen */
        .hidden {
            display: none !important; /* !important, um √úberschreiben zu verhindern */
        }

        .pulse {
            animation: pulse 0.5s ease-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1;}
            50% { transform: scale(1.1); opacity: 0.8;}
            100% { transform: scale(1); opacity: 1;}
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            z-index: 1000;
            animation: celebrate 1s ease-out forwards;
            pointer-events: none;
            opacity: 0;
        }

        @keyframes celebrate {
            0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(1.2) rotate(180deg); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 0; }
        }

        /* Ende Quiz Bildschirm */
        .quiz-end-screen {
            text-align: center;
            padding: 30px;
            background: var(--card-background-light);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            transition: background 0.5s ease, box-shadow 0.5s ease;
        }

        .quiz-end-screen h2 {
            color: #2d3748;
            font-size: 2.2rem;
            margin-bottom: 20px;
        }

        .quiz-end-screen p {
            font-size: 1.1rem;
            color: #4a5568;
            margin-bottom: 15px;
        }

        .quiz-end-screen .btn-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 300px;
            margin: 0 auto;
        }

        /* Arbeitsbl√§tter Ansicht */
        .worksheets-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .worksheet-card {
            background: var(--topic-card-bg-light);
            border: 2px solid var(--topic-card-border-light);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .worksheet-card:hover {
            border-color: #667eea;
            background: #edf2f7;
            transform: translateY(-2px);
        }

        .worksheet-card .worksheet-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .worksheet-card h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .worksheet-card p {
            color: #718096;
            margin-bottom: 15px;
            flex-grow: 1;
        }

        .worksheet-card .btn {
            width: auto;
            padding: 10px 20px;
        }

        /* Dark Mode Switcher Styles */
        .theme-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            border-radius: 50px;
            padding: 8px 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.3s ease, box-shadow 0.3s ease;
        }

        body.dark-mode .theme-switcher {
            background: rgba(25, 25, 25, 0.9);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .theme-switcher button {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 20px;
            transition: all 0.3s ease;
            color: #718096;
        }

        body.dark-mode .theme-switcher button {
            color: #bbbbbb;
        }

        .theme-switcher button.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .theme-switcher button.active {
            background: linear-gradient(45deg, #4a5568, #2d3748);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        /* Responsive Anpassungen */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .subjects-grid, .worksheets-list {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats {
                flex-direction: column;
                gap: 10px;
            }

            .stat-item {
                width: 100%;
                justify-content: center;
            }

            .navigation {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .nav-button {
                width: 100%;
            }

            .topic-view, .quiz-container, .worksheets-container {
                padding: 20px;
            }

            .question-card {
                font-size: 1.1rem;
                padding: 20px;
            }

            .answer-input {
                padding: 12px;
                font-size: 1rem;
            }

            .btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }

            .theme-switcher {
                top: 10px;
                right: 10px;
                padding: 5px 10px;
                font-size: 0.9rem;
            }

            .theme-switcher button {
                font-size: 1rem;
                padding: 3px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="theme-switcher">
            <button id="light-mode-btn" class="active">‚òÄÔ∏è</button>
            <button id="dark-mode-btn">üåô</button>
        </div>

        <div class="header">
            <div class="bean-logo">ü´ò</div>
            <h1>Bohncity Schule</h1>
            <p>Klasse 5 - Interaktive Lernplattform</p>
            <div class="stats">
                <div class="stat-item">
                    <span>üèÜ</span>
                    <span>Punkte: <span id="totalScore">0</span></span>
                </div>
                <div class="stat-item">
                    <span>‚ö°</span>
                    <span>Streak: <span id="totalStreak">0</span></span>
                </div>
                <div class="stat-item">
                    <span>üìö</span>
                    <span>F√§cher: 6</span>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-button active" id="nav-subjects" onclick="showHomeView('subjects')">F√§cher</button>
            <button class="nav-button" id="nav-worksheets" onclick="showHomeView('worksheets')">Arbeitsbl√§tter</button>
        </div>

        <div id="home-subjects-view">
            <div class="subjects-grid">
                <div class="subject-card math" onclick="openSubject('math')">
                    <div class="subject-icon">üî¢</div>
                    <div class="subject-title">Mathematik</div>
                    <div class="subject-description">Rechnen mit nat√ºrlichen Zahlen, Geometrie & Br√ºche</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card german" onclick="openSubject('german')">
                    <div class="subject-icon">üìö</div>
                    <div class="subject-title">Deutsch</div>
                    <div class="subject-description">Wortarten, Satzglieder & Rechtschreibung</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card english" onclick="openSubject('english')">
                    <div class="subject-icon">üá¨üáß</div>
                    <div class="subject-title">Englisch</div>
                    <div class="subject-description">Grundwortschatz & Simple Present</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card science" onclick="openSubject('science')">
                    <div class="subject-icon">üî¨</div>
                    <div class="subject-title">Natur & Technik</div>
                    <div class="subject-description">K√∂rper, Tiere & Stromkreise</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card geography" onclick="openSubject('geography')">
                    <div class="subject-icon">üåç</div>
                    <div class="subject-title">Geographie</div>
                    <div class="subject-description">Kontinente, Deutschland & Karten lesen</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card history" onclick="openSubject('history')">
                    <div class="subject-icon">üìú</div>
                    <div class="subject-title">Geschichte</div>
                    <div class="subject-description">R√∂mer, √Ñgypter & Mittelalter</div>
                    <button class="btn">Starten</button>
                </div>
            </div>
        </div>

        <div id="home-worksheets-view" class="hidden">
            <div class="worksheets-container">
                <h2>Verf√ºgbare Arbeitsbl√§tter</h2>
                <p>Hier kannst du dir passende Arbeitsbl√§tter herunterladen, um dein Wissen zu festigen.</p>
                <div class="worksheets-list" id="worksheets-list-container">
                    </div>
            </div>
        </div>

        <div id="subject-view" class="hidden">
            <button class="back-btn" onclick="showHomeView('subjects')">
                ‚Üê Zur√ºck zur F√§cher√ºbersicht
            </button>
            <div class="topic-view">
                <h2 id="subject-title"></h2>
                <p id="subject-description"></p>
                <div class="topics-grid" id="topics-container"></div>
            </div>
        </div>

        <div id="quiz-view" class="hidden">
            <button class="back-btn" onclick="goToSubject()">
                ‚Üê Zur√ºck zu den Themen
            </button>
            <div class="quiz-container">
                <h2 id="quiz-title"></h2>
                <div class="game-stats">
                    <div class="game-stat">
                        <div class="game-stat-value" id="current-score">0</div>
                        <div class="game-stat-label">Punkte</div>
                    </div>
                    <div class="game-stat">
                        <div class="game-stat-value" id="current-streak">0</div>
                        <div class="game-stat-label">Streak</div>
                    </div>
                    <div class="game-stat">
                        <div class="game-stat-value" id="time-left">60</div>
                        <div class="game-stat-label">Zeit</div>
                    </div>
                </div>
                
                <div class="quiz-progress" id="quiz-progress-text"></div>
                
                <div class="question-card" id="question-container">
                    <div id="question-text">Bereit f√ºr deine erste Aufgabe?</div>
                </div>
                
                <input type="text" class="answer-input" id="answer-input" placeholder="Deine Antwort...">
                
                <div class="feedback" id="feedback"></div>
                
                <button class="btn" id="submit-btn" onclick="checkAnswer()">Antwort pr√ºfen</button>
                <button class="btn hidden" id="next-btn" onclick="nextQuestion()">N√§chste Frage</button>
                <button class="btn" id="start-btn" onclick="startQuiz()">Quiz starten</button>

                <div id="quiz-end-screen" class="quiz-end-screen hidden">
                    <h2>Quiz beendet!</h2>
                    <p>Du hast <span id="final-score">0</span> Punkte erreicht.</p>
                    <p>Richtig beantwortete Fragen: <span id="final-correct-answers">0</span> von <span id="final-total-questions">0</span></p>
                    <div class="btn-group">
                        <button class="btn" onclick="startQuiz()">Nochmal spielen</button>
                        <button class="btn" style="background: #718096;" onclick="goToSubject()">Zur√ºck zum Thema</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSubject = null;
        let currentTopic = null;
        let score = 0;
        let streak = 0;
        let totalScore = parseInt(localStorage.getItem('totalScore') || '0');
        let totalStreak = parseInt(localStorage.getItem('totalStreak') || '0');
        let timeLeft = 60;
        let gameActive = false;
        let currentQuestion = null;
        let timer = null;
        let totalQuestionsAttempted = 0; // Fragen, die im aktuellen Quiz gestellt wurden
        let correctAnswersCount = 0; // Richtige Antworten im aktuellen Quiz
        let questionsForQuiz = []; // Fragen f√ºr das aktuelle Quiz
        let questionIndex = 0; // Aktueller Index der Frage im Quiz

        // --- HIER PASST DU DEINE VERF√úGBAREN ARBEITSBL√ÑTTER AN! ---
        // F√ºge hier Eintr√§ge f√ºr JEDES PDF hinzu, das du in deinem Ordner hast.
        // Der Code generiert dann automatisch die Karte daf√ºr.
        const availableWorksheets = [
            { fileName: 'deutsch_wortarten.pdf', title: 'Deutsch - Wortarten', description: 'Arbeitsblatt zum Erkennen und Bestimmen von Nomen, Verben und Adjektiven.' },
            { fileName: 'mathe.pdf', title: 'Mathematik - Allgemeine √úbungen', description: 'Ein umfassendes √úbungsblatt f√ºr verschiedene mathematische Themen.' },
            { fileName: 'english_vocabulary.pdf', title: 'Englisch - Basic Vocabulary', description: '√úbe grundlegende englische W√∂rter und S√§tze f√ºr den Alltag.' },
            { fileName: 'natur_menschlicher_koerper.pdf', title: 'Natur & Technik - Der menschliche K√∂rper', description: 'Entdecke die wichtigsten Organe und Funktionen deines K√∂rpers.' },
            { fileName: 'geographie_deutschland.pdf', title: 'Geographie - Deutschland Bundesl√§nder', description: 'Lerne die 16 Bundesl√§nder Deutschlands und ihre Hauptst√§dte kennen.' },
            { fileName: 'geschichte_aegypten.pdf', title: 'Geschichte - Das Alte √Ñgypten', description: 'Reise zur√ºck zu den Pharaonen, Pyramiden und dem Nil.' },
            // Beispiel f√ºr weitere PDFs, die du hinzuf√ºgen k√∂nntest:
            // { fileName: 'mathe_addition.pdf', title: 'Mathematik - Addition & Subtraktion', description: '√úbungsblatt zu den Grundrechenarten im Zahlenraum bis 1000.' },
            // { fileName: 'deutsch_satzzeichen.pdf', title: 'Deutsch - Satzzeichen', description: '√úbe den korrekten Einsatz von Punkt, Komma und Fragezeichen.' },
            // { fileName: 'english_simple_present.pdf', title: 'Englisch - Simple Present', description: '√úbungsblatt zur Bildung und Anwendung des Simple Present.' },
            // ... und so weiter f√ºr alle anderen, die du noch erstellen m√∂chtest.
        ];


        // Datenstrukturen f√ºr F√§cher, Themen und Fragen
        // Fragen wurden mit zus√§tzlichen Erkl√§rungen versehen, um besseres Feedback zu erm√∂glichen
        const subjects = {
            math: {
                name: 'Mathematik',
                icon: 'üî¢',
                description: 'Rechnen mit nat√ºrlichen Zahlen, Geometrie & Br√ºche',
                topics: [
                    { id: 'addition', name: 'Addition & Subtraktion', description: 'Grundrechenarten √ºben' },
                    { id: 'multiplication', name: 'Multiplikation & Division', description: 'Einmaleins und Teilen' },
                    { id: 'fractions', name: 'Br√ºche', description: 'Einf√ºhrung in Br√ºche' },
                    { id: 'geometry', name: 'Geometrie', description: 'Formen und Fl√§chen' },
                    { id: 'units', name: 'Ma√üeinheiten', description: 'L√§ngen, Gewichte, Zeit' },
                    { id: 'word_problems', name: 'Sachaufgaben', description: 'Mathematik im Alltag' }
                ]
            },
            german: {
                name: 'Deutsch',
                icon: 'üìö',
                description: 'Sprache, Rechtschreibung und Texte verstehen',
                topics: [
                    { id: 'word_types', name: 'Wortarten', description: 'Nomen, Verben, Adjektive' },
                    { id: 'sentence_parts', name: 'Satzglieder', description: 'Subjekt, Pr√§dikat, Objekt' },
                    { id: 'tenses', name: 'Zeitformen', description: 'Pr√§sens, Pr√§teritum, Perfekt' },
                    { id: 'spelling', name: 'Rechtschreibung', description: 'Richtig schreiben' },
                    { id: 'texts', name: 'Texte schreiben', description: 'Beschreibungen und Berichte' },
                    { id: 'reading', name: 'Lesen & Verstehen', description: 'Texte erfassen' }
                ]
            },
            english: {
                name: 'Englisch',
                icon: 'üá¨üáß',
                description: 'Grundlagen der englischen Sprache',
                topics: [
                    { id: 'vocabulary', name: 'Grundwortschatz', description: 'Familie, Schule, Freizeit' },
                    { id: 'simple_present', name: 'Simple Present', description: 'Gegenwart auf Englisch' },
                    { id: 'pronouns', name: 'Pronomen', description: 'I, you, he, she, it' },
                    { id: 'questions', name: 'Fragen stellen', description: 'What, where, when, why' },
                    { id: 'conversations', name: 'Gespr√§che', description: 'Begr√º√üung und Small Talk' },
                    { id: 'writing', name: 'Texte schreiben', description: 'Kurze Texte verfassen' }
                ]
            },
            science: {
                name: 'Natur & Technik',
                icon: 'üî¨',
                description: 'Forschen und die Welt verstehen',
                topics: [
                    { id: 'senses', name: 'Sinne', description: 'Sehen, H√∂ren, Riechen, Schmecken' },
                    { id: 'body', name: 'Menschlicher K√∂rper', description: 'Bewegung und Gesundheit' },
                    { id: 'animals', name: 'Tiere', description: 'Lebensr√§ume und Verhalten' },
                    { id: 'plants', name: 'Pflanzen', description: 'Wachstum und Photosynthese' },
                    { id: 'electricity', name: 'Strom', description: 'Stromkreise und Ger√§te' },
                    { id: 'environment', name: 'Umwelt', description: 'Nachhaltigkeit und Schutz' }
                ]
            },
            geography: {
                name: 'Geographie',
                icon: 'üåç',
                description: 'Die Welt entdecken und verstehen',
                topics: [
                    { id: 'directions', name: 'Himmelsrichtungen', description: 'Norden, S√ºden, Osten, Westen' },
                    { id: 'continents', name: 'Kontinente', description: 'Europa, Asien, Afrika...' },
                    { id: 'germany', name: 'Deutschland', description: 'Bundesl√§nder und Gebirge' },
                    { id: 'maps', name: 'Karten lesen', description: 'Orientierung und Ma√üstab' },
                    { id: 'climate', name: 'Klima', description: 'Wetter und Klimazonen' },
                    { id: 'cities', name: 'St√§dte & L√§nder', description: 'Hauptst√§dte Europas' }
                ]
            },
            history: {
                name: 'Geschichte',
                icon: 'üìú',
                description: 'Reise in die Vergangenheit',
                topics: [
                    { id: 'timeline', name: 'Zeitrechnung', description: 'v. Chr. und n. Chr.' },
                    { id: 'egypt', name: 'Altes √Ñgypten', description: 'Pharaonen und Pyramiden' },
                    { id: 'greece', name: 'Griechenland', description: 'Demokratie und G√∂tter' },
                    { id: 'rome', name: 'R√∂misches Reich', description: 'Gladiatoren und Legionen' },
                    { id: 'medieval', name: 'Mittelalter', description: 'Ritter und Burgen' },
                    { id: 'sources', name: 'Quellen', description: 'Wie erforscht man Geschichte?' }
                ]
            }
        };

        const questions = {
            math: {
                addition: [
                    { question: "Was ist 25 + 17?", answer: "42", explanation: "Die Summe ist 42." },
                    { question: "Was ist 84 - 29?", answer: "55", explanation: "Die Differenz ist 55." },
                    { question: "Was ist 156 + 78?", answer: "234", explanation: "Addiere die Zahlen, um 234 zu erhalten." },
                    { question: "Was ist 200 - 85?", answer: "115", explanation: "Subtrahiere, um 115 zu bekommen." },
                    { question: "Was ist 47 + 38?", answer: "85", explanation: "47 + 38 ergibt 85." },
                    { question: "Was ist 123 - 67?", answer: "56", explanation: "123 minus 67 ist 56." },
                    { question: "Was ist 33 + 44?", answer: "77", explanation: "Die Summe von 33 und 44 ist 77." },
                    { question: "Was ist 91 - 19?", answer: "72", explanation: "Die Differenz ist 72." },
                    { question: "Was ist 500 + 250?", answer: "750", explanation: "Halbiere 500 und addiere es zu 500." },
                    { question: "Was ist 1000 - 333?", answer: "667", explanation: "Rechne 1000 minus 333." }
                ],
                multiplication: [
                    { question: "Was ist 7 √ó 8?", answer: "56", explanation: "7 mal 8 ist 56." },
                    { question: "Was ist 9 √ó 6?", answer: "54", explanation: "9 mal 6 ist 54." },
                    { question: "Was ist 72 √∑ 8?", answer: "9", explanation: "72 geteilt durch 8 ist 9." },
                    { question: "Was ist 45 √∑ 5?", answer: "9", explanation: "45 geteilt durch 5 ist 9." },
                    { question: "Was ist 8 √ó 7?", answer: "56", explanation: "Die Produkt von 8 und 7 ist 56." },
                    { question: "Was ist 63 √∑ 9?", answer: "7", explanation: "63 geteilt durch 9 ist 7." },
                    { question: "Was ist 11 √ó 11?", answer: "121", explanation: "11 mal 11 ist 121." },
                    { question: "Was ist 12 √ó 12?", answer: "144", explanation: "12 mal 12 ist 144." },
                    { question: "Was ist 100 √∑ 10?", answer: "10", explanation: "100 geteilt durch 10 ist 10." },
                    { question: "Was ist 81 √∑ 9?", answer: "9", explanation: "81 geteilt durch 9 ist 9." }
                ],
                fractions: [
                    { question: "Was ist 1/2 + 1/4?", answer: "3/4", explanation: "1/2 sind 2/4. Also 2/4 + 1/4 = 3/4." },
                    { question: "Was ist gr√∂√üer: 1/3 oder 1/4?", answer: "1/3", explanation: "Je kleiner der Nenner, desto gr√∂√üer der Bruch (wenn Z√§hler gleich ist)." },
                    { question: "Was ist 1/2 von 8?", answer: "4", explanation: "Die H√§lfte von 8 ist 4." },
                    { question: "Was ist 1/4 von 12?", answer: "3", explanation: "Ein Viertel von 12 ist 3." },
                    { question: "Wie schreibt man eine halbe Pizza als Bruch?", answer: "1/2", explanation: "Eine halbe Pizza ist 1/2." },
                    { question: "Wie viele Viertel sind ein Ganzes?", answer: "4", explanation: "Vier Viertel ergeben ein Ganzes (4/4)." }
                ],
                geometry: [
                    { question: "Wie viele Ecken hat ein Dreieck?", answer: "3", explanation: "Ein Dreieck hat drei Ecken." },
                    { question: "Wie viele Seiten hat ein Rechteck?", answer: "4", explanation: "Ein Rechteck hat vier Seiten." },
                    { question: "Wie hei√üt ein Viereck mit 4 gleichen Seiten?", answer: "quadrat", explanation: "Ein Quadrat hat vier gleiche Seiten und vier rechte Winkel." },
                    { question: "Wie viele Ecken hat ein Kreis?", answer: "0", explanation: "Ein Kreis hat keine Ecken." },
                    { question: "Welche Form hat eine Tafel Schokolade?", answer: "rechteck", explanation: "Viele Tafeln Schokolade sind rechteckig." },
                    { question: "Wie nennt man eine Figur mit 5 Ecken?", answer: "f√ºnfeck", explanation: "Eine Figur mit 5 Ecken ist ein F√ºnfeck oder Pentagon." }
                ],
                units: [
                    { question: "Wie viele Zentimeter sind 1 Meter?", answer: "100", explanation: "1 Meter entspricht 100 Zentimetern." },
                    { question: "Wie viele Minuten sind 1 Stunde?", answer: "60", explanation: "Eine Stunde hat 60 Minuten." },
                    { question: "Wie viele Gramm sind 1 Kilogramm?", answer: "1000", explanation: "Ein Kilogramm sind 1000 Gramm." },
                    { question: "Wie viele Sekunden sind 1 Minute?", answer: "60", explanation: "Eine Minute hat 60 Sekunden." },
                    { question: "Wie viele Tage hat ein Schaltjahr?", answer: "366", explanation: "Ein Schaltjahr hat einen zus√§tzlichen Tag im Februar (366 statt 365)." },
                    { question: "Wie viele Milliliter sind 1 Liter?", answer: "1000", explanation: "Ein Liter sind 1000 Milliliter." }
                ],
                word_problems: [
                    { question: "Lisa hat 15 √Ñpfel. Sie gibt 7 weg. Wie viele bleiben?", answer: "8", explanation: "15 minus 7 ergibt 8." },
                    { question: "In einer Klasse sind 12 Jungen und 13 M√§dchen. Wie viele Kinder insgesamt?", answer: "25", explanation: "12 plus 13 ergibt 25." },
                    { question: "Ein Buch kostet 8 Euro. Wie viel kosten 3 B√ºcher?", answer: "24", explanation: "3 mal 8 Euro sind 24 Euro." },
                    { question: "24 Bonbons werden gleichm√§√üig auf 6 Kinder verteilt. Wie viele bekommt jedes?", answer: "4", explanation: "24 geteilt durch 6 ist 4." },
                    { question: "Ein B√§cker backt 100 Br√∂tchen. 45 werden verkauft. Wie viele sind √ºbrig?", answer: "55", explanation: "100 minus 45 ergibt 55." },
                    { question: "Ein Zug f√§hrt mit 60 km/h. Wie weit f√§hrt er in 2 Stunden?", answer: "120", explanation: "60 km/h mal 2 Stunden sind 120 km." }
                ]
            },
            german: {
                word_types: [
                    { question: "Welche Wortart ist 'Hund'?", answer: "nomen", explanation: "Hund ist ein Nomen (Hauptwort), da man 'der Hund' sagen kann." },
                    { question: "Welche Wortart ist 'laufen'?", answer: "verb", explanation: "Laufen ist ein Verb (Tunwort), es beschreibt eine T√§tigkeit." },
                    { question: "Welche Wortart ist 'sch√∂n'?", answer: "adjektiv", explanation: "Sch√∂n ist ein Adjektiv (Eigenschaftswort), es beschreibt, wie etwas ist." },
                    { question: "Welche Wortart ist 'schnell'?", answer: "adjektiv", explanation: "Schnell ist ein Adjektiv, es beschreibt eine Eigenschaft." },
                    { question: "Welche Wortart ist 'spielen'?", answer: "verb", explanation: "Spielen ist ein Verb, da es eine Handlung beschreibt." },
                    { question: "Welche Wortart ist 'Baum'?", answer: "nomen", explanation: "Baum ist ein Nomen, da es ein Ding benennt." },
                    { question: "Welche Wortart ist 'gr√ºn'?", answer: "adjektiv", explanation: "Gr√ºn ist ein Adjektiv, es beschreibt eine Farbe." },
                    { question: "Welche Wortart ist 'lesen'?", answer: "verb", explanation: "Lesen ist ein Verb, da es eine T√§tigkeit ausdr√ºckt." }
                ],
                sentence_parts: [
                    { question: "Was ist das Subjekt im Satz: 'Der Hund bellt'?", answer: "der hund", explanation: "Das Subjekt ist 'Der Hund', denn 'Wer oder was bellt?' -> 'Der Hund'." },
                    { question: "Was ist das Pr√§dikat im Satz: 'Maria singt'?", answer: "singt", explanation: "Das Pr√§dikat ist 'singt', es ist das Verb im Satz." },
                    { question: "Was fragt man nach dem Subjekt?", answer: "wer oder was", explanation: "Nach dem Subjekt fragt man 'Wer oder was?'." },
                    { question: "Was fragt man nach dem Akkusativ-Objekt?", answer: "wen oder was", explanation: "Nach dem Akkusativ-Objekt fragt man 'Wen oder was?'." },
                    { question: "Was ist der Nominativ?", answer: "wer oder was", explanation: "Der Nominativ ist der 1. Fall ('Wer oder was?')." },
                    { question: "Was ist der Dativ?", answer: "wem", explanation: "Der Dativ ist der 3. Fall ('Wem?')." },
                ],
                tenses: [
                    { question: "In welcher Zeitform steht: 'Ich gehe'?", answer: "pr√§sens", explanation: "Das ist Pr√§sens (Gegenwart)." },
                    { question: "In welcher Zeitform steht: 'Ich ging'?", answer: "pr√§teritum", explanation: "Das ist Pr√§teritum (Vergangenheit), auch einfache Vergangenheit genannt." },
                    { question: "Wie hei√üt die Vergangenheitsform von 'spielen'?", answer: "spielte", explanation: "Die Pr√§teritum-Form von 'spielen' ist 'spielte'." },
                    { question: "Wie hei√üt die Grundform von 'l√§uft'?", answer: "laufen", explanation: "Die Grundform (Infinitiv) von 'l√§uft' ist 'laufen'." },
                    { question: "Wie hei√üt die Perfektform von 'essen'?", answer: "gegessen", explanation: "Die Perfektform ist 'hat gegessen'." },
                    { question: "Nenne ein Signalwort f√ºr Pr√§sens.", answer: "jetzt", explanation: "Signalw√∂rter f√ºr Pr√§sens sind z.B. 'jetzt', 'immer', 'oft'." }
                ],
                spelling: [
                    { question: "Schreibe richtig: 'Das ist ein sh√∂ner Tag'", answer: "das ist ein sch√∂ner tag", explanation: "Der Buchstabe 'sch' wird verwendet." },
                    { question: "Schreibe richtig: 'Ich gehe ins Kino'", answer: "ich gehe ins kino", explanation: "Nomen werden gro√ügeschrieben, also 'Kino'." },
                    { question: "Wie schreibt man: 'Ich bin gl√ºklich'?", answer: "ich bin gl√ºcklich", explanation: "'Gl√ºcklich' wird mit 'ck' geschrieben." },
                    { question: "Wie schreibt man: 'Das M√§dhen spielt'?", answer: "das m√§dchen spielt", explanation: "'M√§dchen' wird mit 'ch' geschrieben." },
                    { question: "Wie schreibt man 'Fahrrad' richtig?", answer: "fahrrad", explanation: "'Fahrrad' hat zwei 'r'." },
                    { question: "Wie viele 's' hat das Wort 'Wasser'?", answer: "2", explanation: "'Wasser' hat zwei 's'." }
                ],
                texts: [
                    { question: "Womit beginnt ein Satz?", answer: "gro√übuchstabe", explanation: "Ein Satz beginnt immer mit einem Gro√übuchstaben." },
                    { question: "Womit endet ein Aussagesatz?", answer: "punkt", explanation: "Ein Aussagesatz endet mit einem Punkt." },
                    { question: "Womit endet ein Fragesatz?", answer: "fragezeichen", explanation: "Ein Fragesatz endet mit einem Fragezeichen." },
                    { question: "Wie nennt man eine Geschichte √ºber sich selbst?", answer: "erz√§hlung", explanation: "Eine Geschichte √ºber sich selbst ist eine Erz√§hlung oder Autobiografie." },
                    { question: "Was ist eine √úberschrift?", answer: "titel", explanation: "Eine √úberschrift ist der Titel oder die Bezeichnung eines Textes." },
                    { question: "Was sind Abs√§tze in einem Text?", answer: "textteile", explanation: "Abs√§tze sind Gliederungen, die den Text in Sinnabschnitte unterteilen." }
                ],
                reading: [
                    { question: "Wer ist der Hauptcharakter in einem Text?", answer: "protagonist", explanation: "Der Hauptcharakter wird auch Protagonist genannt." },
                    { question: "Wie nennt man den Anfang einer Geschichte?", answer: "einleitung", explanation: "Der Anfang einer Geschichte ist die Einleitung." },
                    { question: "Was beschreibt die Handlung einer Geschichte?", answer: "plot", explanation: "Der Plot beschreibt die Abfolge der Ereignisse." },
                    { question: "Wie nennt man das Ende einer Geschichte?", answer: "schluss", explanation: "Das Ende einer Geschichte ist der Schluss oder die Aufl√∂sung." },
                    { question: "Was ist eine Textsorte?", answer: "art des textes", explanation: "Eine Textsorte ist eine bestimmte Art von Text (z.B. M√§rchen, Bericht, Gedicht)." },
                    { question: "Was ist die Kernaussage eines Textes?", answer: "hauptbotschaft", explanation: "Die Kernaussage ist die wichtigste Information oder Botschaft des Textes." }
                ]
            },
            english: {
                vocabulary: [
                    { question: "Wie hei√üt 'Hund' auf Englisch?", answer: "dog", explanation: "Hund ist 'dog'." },
                    { question: "Wie hei√üt 'Katze' auf Englisch?", answer: "cat", explanation: "Katze ist 'cat'." },
                    { question: "Wie hei√üt 'Haus' auf Englisch?", answer: "house", explanation: "Haus ist 'house'." },
                    { question: "Wie hei√üt 'Schule' auf Englisch?", answer: "school", explanation: "Schule ist 'school'." },
                    { question: "Wie hei√üt 'Buch' auf Englisch?", answer: "book", explanation: "Buch ist 'book'." },
                    { question: "Wie hei√üt 'Auto' auf Englisch?", answer: "car", explanation: "Auto ist 'car'." },
                    { question: "Wie hei√üt 'Apfel' auf Englisch?", answer: "apple", explanation: "Apfel ist 'apple'." },
                    { question: "Wie hei√üt 'Wasser' auf Englisch?", answer: "water", explanation: "Wasser ist 'water'." }
                ],
                simple_present: [
                    { question: "He ___ to school every day. (go)", answer: "goes", explanation: "Bei 'he/she/it' wird ein '-s' an das Verb angeh√§ngt." },
                    { question: "She ___ her homework. (do)", answer: "does", explanation: "'Do' wird zu 'does' bei 'he/she/it'." },
                    { question: "I ___ English. (speak)", answer: "speak", explanation: "Bei 'I/you/we/they' bleibt das Verb in der Grundform." },
                    { question: "We ___ football. (play)", answer: "play", explanation: "Die Grundform 'play' ist korrekt f√ºr 'we'." },
                    { question: "The cat ___ milk. (drink)", answer: "drinks", explanation: "'The cat' ist wie 'it', also 'drinks'." },
                    { question: "They ___ happy. (be)", answer: "are", explanation: "'To be' wird zu 'are' bei 'they'." },
                    { question: "The sun ___ in the east. (rise)", answer: "rises", explanation: "'The sun' ist wie 'it', also 'rises'." }
                ],
                pronouns: [
                    { question: "Welches Pronomen steht f√ºr 'ich'?", answer: "i", explanation: "'Ich' auf Englisch ist 'I'." },
                    { question: "Welches Pronomen steht f√ºr 'du'?", answer: "you", explanation: "'Du' auf Englisch ist 'you'." },
                    { question: "Welches Pronomen steht f√ºr 'er'?", answer: "he", explanation: "'Er' auf Englisch ist 'he'." },
                    { question: "Welches Pronomen steht f√ºr 'sie' (weiblich)?", answer: "she", explanation: "'Sie' (weiblich) auf Englisch ist 'she'." },
                    { question: "Welches Pronomen steht f√ºr 'es'?", answer: "it", explanation: "'Es' auf Englisch ist 'it'." },
                    { question: "Welches Pronomen steht f√ºr 'wir'?", answer: "we", explanation: "'Wir' auf Englisch ist 'we'." },
                    { question: "Welches Pronomen steht f√ºr 'ihr' (plural)?", answer: "you", explanation: "'Ihr' (plural) auf Englisch ist 'you'." },
                    { question: "Welches Pronomen steht f√ºr 'sie' (plural)?", answer: "they", explanation: "'Sie' (plural) auf Englisch ist 'they'." }
                ],
                questions: [
                    { question: "Wie fragt man: 'Was ist das?'", answer: "what is that", explanation: "Die korrekte Frage ist 'What is that?'." },
                    { question: "Wie fragt man: 'Wo ist die Schule?'", answer: "where is the school", explanation: "Die korrekte Frage ist 'Where is the school?'." },
                    { question: "Wie fragt man: 'Wann gehst du?'", answer: "when do you go", explanation: "Die korrekte Frage ist 'When do you go?'." },
                    { question: "Wie fragt man: 'Warum weinst du?'", answer: "why do you cry", explanation: "Die korrekte Frage ist 'Why do you cry?'." },
                    { question: "Wie fragt man nach einer Person?", answer: "who", explanation: "Man fragt mit 'Who' nach einer Person." },
                    { question: "Wie fragt man nach einer Sache?", answer: "what", explanation: "Man fragt mit 'What' nach einer Sache." }
                ],
                conversations: [
                    { question: "Wie begr√º√üt man jemanden am Morgen?", answer: "good morning", explanation: "'Good morning' ist die typische Begr√º√üung am Morgen." },
                    { question: "Wie verabschiedet man sich am Abend?", answer: "good night", explanation: "'Good night' sagt man zur Verabschiedung am Abend." },
                    { question: "Wie fragt man jemanden nach seinem Namen?", answer: "what is your name", explanation: "Die Frage 'What is your name?' wird verwendet." },
                    { question: "Wie antwortet man auf 'How are you?'", answer: "i am fine", explanation: "Eine typische Antwort ist 'I am fine, thank you.'." },
                    { question: "Wie entschuldigt man sich?", answer: "i am sorry", explanation: "Man entschuldigt sich mit 'I am sorry'." },
                    { question: "Wie bedankt man sich?", answer: "thank you", explanation: "Man bedankt sich mit 'Thank you'." }
                ],
                writing: [
                    { question: "Wie beginnt man einen einfachen Satz auf Englisch?", answer: "subjekt verb", explanation: "Ein einfacher Satz beginnt oft mit Subjekt, gefolgt vom Verb (z.B. I play)." },
                    { question: "Was ist ein 'full stop'?", answer: "punkt", explanation: "Ein 'full stop' ist ein Punkt (.) am Ende eines Satzes." },
                    { question: "Was ist ein 'comma'?", answer: "komma", explanation: "Ein 'comma' ist ein Komma (,)." },
                    { question: "Wie schreibt man das Wort 'colour' (UK) auf US-Englisch?", answer: "color", explanation: "Auf US-Englisch wird 'colour' zu 'color'." },
                    { question: "Welcher Buchstabe ist im Englischen immer gro√ü?", answer: "i", explanation: "Das Pronomen 'I' (ich) wird immer gro√ügeschrieben." }
                ]
            },
            science: {
                senses: [
                    { question: "Mit welchem Sinn nehmen wir Farben wahr?", answer: "sehen", explanation: "Wir nehmen Farben mit dem Sehsinn wahr (Augen)." },
                    { question: "Mit welchem Organ h√∂ren wir?", answer: "ohren", explanation: "Wir h√∂ren mit den Ohren." },
                    { question: "Welcher Sinn hilft uns, Ger√ºche zu erkennen?", answer: "riechen", explanation: "Der Geruchssinn (Nase) hilft uns dabei." },
                    { question: "Welche Geschmacksrichtungen gibt es (mindestens 4)?", answer: "s√ºss salzig sauer bitter", explanation: "Die vier Grundgeschmacksrichtungen sind s√º√ü, salzig, sauer, bitter (und umami)." },
                    { question: "Welches Organ ist f√ºr den Geschmack zust√§ndig?", answer: "zunge", explanation: "Die Zunge ist das Geschmacksorgan." },
                    { question: "Welcher Sinn sch√ºtzt uns vor zu gro√üer Hitze?", answer: "tastsinn", explanation: "Der Tastsinn (Haut) warnt uns vor Hitze und K√§lte." }
                ],
                body: [
                    { question: "Welches Organ pumpt Blut durch den K√∂rper?", answer: "herz", explanation: "Das Herz pumpt Blut und versorgt den K√∂rper." },
                    { question: "Welches Organ verarbeitet unsere Nahrung?", answer: "magen", explanation: "Der Magen zersetzt die Nahrung." },
                    { question: "Wie hei√üen die Organe, mit denen wir atmen?", answer: "lunge", explanation: "Wir atmen mit der Lunge (oder Lungen)." },
                    { question: "Woraus besteht unser Skelett?", answer: "knochen", explanation: "Das Skelett besteht aus vielen Knochen." },
                    { question: "Welches Organ ist die Steuerzentrale unseres K√∂rpers?", answer: "gehirn", explanation: "Das Gehirn steuert alle K√∂rperfunktionen." },
                    { question: "Welches Gelenk verbindet Ober- und Unterschenkel?", answer: "knie", explanation: "Das Kniegelenk verbindet Ober- und Unterschenkel." }
                ],
                animals: [
                    { question: "Welches Tier ist ein S√§ugetier und kann fliegen?", answer: "fledermaus", explanation: "Die Fledermaus ist das einzige fliegende S√§ugetier." },
                    { question: "Welches Tier legt Eier und hat Federn?", answer: "vogel", explanation: "V√∂gel legen Eier und haben Federn." },
                    { question: "Welches Tier lebt im Wasser und atmet durch Kiemen?", answer: "fisch", explanation: "Fische leben im Wasser und atmen mit Kiemen." },
                    { question: "Nenne ein Tier, das Winterschlaf h√§lt.", answer: "igel", explanation: "Igel, B√§ren und Murmeltiere halten Winterschlaf." },
                    { question: "Welches Insekt produziert Honig?", answer: "biene", explanation: "Bienen produzieren Honig." },
                    { question: "Wie nennt man die Entwicklung vom Ei zur Raupe zum Schmetterling?", answer: "metamorphose", explanation: "Dieser Prozess wird Metamorphose genannt." }
                ],
                plants: [
                    { question: "Welches Teil der Pflanze w√§chst unter der Erde und nimmt Wasser auf?", answer: "wurzel", explanation: "Die Wurzeln nehmen Wasser und N√§hrstoffe auf." },
                    { question: "Welches Gas nehmen Pflanzen zum Wachsen auf?", answer: "kohlendioxid", explanation: "Pflanzen nehmen Kohlendioxid auf und geben Sauerstoff ab (Photosynthese)." },
                    { question: "Wie hei√üt der Vorgang, bei dem Pflanzen Nahrung aus Licht herstellen?", answer: "photosynthese", explanation: "Dies ist die Photosynthese." },
                    { question: "Welche Farbe hat das Chlorophyll in Pflanzen?", answer: "gr√ºn", explanation: "Chlorophyll ist der gr√ºne Farbstoff in Pflanzen." },
                    { question: "Wozu dienen Bl√ºten einer Pflanze?", answer: "fortpflanzung", explanation: "Bl√ºten dienen der Fortpflanzung der Pflanze." },
                    { question: "Nenne ein Gem√ºse, das unter der Erde w√§chst.", answer: "karotte", explanation: "Karotten, Kartoffeln oder Radieschen wachsen unter der Erde." }
                ],
                electricity: [
                    { question: "Was flie√üt in einem Stromkreis?", answer: "strom", explanation: "Strom oder Elektrizit√§t flie√üt in einem Stromkreis." },
                    { question: "Nenne ein Material, das Strom gut leitet.", answer: "kupfer", explanation: "Metalle wie Kupfer oder Aluminium leiten Strom gut." },
                    { question: "Nenne ein Material, das Strom nicht leitet (Isolator).", answer: "plastik", explanation: "Plastik, Gummi oder Holz leiten Strom nicht gut (sind Isolatoren)." },
                    { question: "Was sch√ºtzt uns vor Stromschl√§gen in einem Kabel?", answer: "isolierung", explanation: "Die Isolierung um das Kabel sch√ºtzt uns." },
                    { question: "Was ist eine Energiequelle f√ºr Strom (au√üer Steckdose)?", answer: "batterie", explanation: "Batterien, Solarenergie, Windkraft sind Energiequellen." },
                    { question: "Was erzeugt Licht in einer Lampe?", answer: "gl√ºhbirne", explanation: "Die Gl√ºhbirne (oder LED) erzeugt Licht." }
                ],
                environment: [
                    { question: "Was passiert, wenn man zu viel M√ºll in die Natur wirft?", answer: "verschmutzung", explanation: "Das f√ºhrt zu Umweltverschmutzung." },
                    { question: "Wie kann man M√ºll reduzieren?", answer: "recycling", explanation: "Durch Recycling, Wiederverwendung und M√ºllvermeidung." },
                    { question: "Welches Gas ist f√ºr den Treibhauseffekt mitverantwortlich?", answer: "kohlendioxid", explanation: "Kohlendioxid (CO2) ist ein Treibhausgas." },
                    { question: "Warum ist es wichtig, Wasser zu sparen?", answer: "ressource", explanation: "Wasser ist eine wichtige und begrenzte Ressource." },
                    { question: "Nenne ein Beispiel f√ºr erneuerbare Energie.", answer: "sonnenenergie", explanation: "Sonnenenergie (Solar), Windenergie, Wasserkraft sind erneuerbare Energien." },
                    { question: "Was ist der Lebensraum vieler Tiere und Pflanzen im Wald?", answer: "√∂kosystem", explanation: "Der Wald ist ein wichtiges √ñkosystem." }
                ]
            },
            geography: {
                directions: [
                    { question: "Gegen√ºber von Norden ist...", answer: "s√ºden", explanation: "Gegen√ºber von Norden ist S√ºden." },
                    { question: "Zwischen Norden und Osten liegt...", answer: "nordosten", explanation: "Zwischen Norden und Osten liegt Nordosten." },
                    { question: "In welche Himmelsrichtung geht die Sonne auf?", answer: "osten", explanation: "Die Sonne geht im Osten auf." },
                    { question: "In welche Himmelsrichtung geht die Sonne unter?", answer: "westen", explanation: "Die Sonne geht im Westen unter." },
                    { question: "Wenn du nach Norden schaust, was ist dann rechts?", answer: "osten", explanation: "Wenn du nach Norden schaust, ist Osten rechts." },
                    { question: "Wenn du nach S√ºden schaust, was ist dann links?", answer: "osten", explanation: "Wenn du nach S√ºden schaust, ist Osten links." }
                ],
                continents: [
                    { question: "Nenne den gr√∂√üten Kontinent der Erde.", answer: "asien", explanation: "Asien ist der gr√∂√üte Kontinent." },
                    { question: "Auf welchem Kontinent leben Pinguine (nat√ºrlich)?", answer: "antarktis", explanation: "Pinguine leben nat√ºrlich in der Antarktis." },
                    { question: "Nenne einen Kontinent, der vollst√§ndig auf der S√ºdhalbkugel liegt.", answer: "australien", explanation: "Australien ist vollst√§ndig auf der S√ºdhalbkugel." },
                    { question: "Wie viele Kontinente gibt es auf der Erde?", answer: "7", explanation: "Es gibt 7 Kontinente (Asien, Afrika, Nordamerika, S√ºdamerika, Antarktis, Europa, Australien)." },
                    { question: "Welcher Kontinent ist als 'Wiege der Menschheit' bekannt?", answer: "afrika", explanation: "Afrika gilt als die Wiege der Menschheit." },
                    { question: "Welcher Kontinent ist sehr kalt und hat viel Eis?", answer: "antarktis", explanation: "Die Antarktis ist ein eisiger Kontinent." }
                ],
                germany: [
                    { question: "Wie hei√üt die Hauptstadt von Deutschland?", answer: "berlin", explanation: "Berlin ist die Hauptstadt von Deutschland." },
                    { question: "Nenne ein gro√ües Gebirge in S√ºddeutschland.", answer: "alpen", explanation: "Die Alpen sind ein gro√ües Gebirge im S√ºden Deutschlands." },
                    { question: "Wie viele Bundesl√§nder hat Deutschland?", answer: "16", explanation: "Deutschland hat 16 Bundesl√§nder." },
                    { question: "Welcher gro√üe Fluss flie√üt durch K√∂ln und D√ºsseldorf?", answer: "rhein", explanation: "Der Rhein flie√üt durch diese St√§dte." },
                    { question: "Nenne das n√∂rdlichste Bundesland.", answer: "schleswig-holstein", explanation: "Schleswig-Holstein ist das n√∂rdlichste Bundesland." },
                    { question: "Nenne die gr√∂√üte Insel Deutschlands.", answer: "r√ºgen", explanation: "R√ºgen ist die gr√∂√üte Insel Deutschlands." }
                ],
                maps: [
                    { question: "Was zeigt die Farbe Blau auf einer Karte an?", answer: "wasser", explanation: "Blau zeigt Wasserfl√§chen (Fl√ºsse, Seen, Meere) an." },
                    { question: "Was ist ein Ma√üstab auf einer Karte?", answer: "verh√§ltnis", explanation: "Der Ma√üstab zeigt das Verh√§ltnis zwischen Karte und Wirklichkeit an." },
                    { question: "Was sind Breiten- und L√§ngengrade?", answer: "koordinaten", explanation: "Das sind Linien, die zur Positionsbestimmung auf der Erde dienen." },
                    { question: "Was ist eine Legende auf einer Karte?", answer: "zeichenerkl√§rung", explanation: "Die Legende erkl√§rt die Symbole und Farben auf der Karte." },
                    { question: "Was zeigt eine politische Karte?", answer: "grenzen", explanation: "Eine politische Karte zeigt L√§ndergrenzen und Hauptst√§dte." },
                    { question: "Was zeigt eine physische Karte?", answer: "landschaft", explanation: "Eine physische Karte zeigt nat√ºrliche Merkmale wie Berge und Fl√ºsse." }
                ],
                climate: [
                    { question: "Was ist der Unterschied zwischen Wetter und Klima?", answer: "zeitraum", explanation: "Wetter ist kurzfristig, Klima ist langfristig." },
                    { question: "Welches Wetterph√§nomen entsteht bei Gewittern?", answer: "blitz", explanation: "Blitze und Donner sind typisch f√ºr Gewitter." },
                    { question: "Wie nennt man eine lange Zeit ohne Regen?", answer: "d√ºrre", explanation: "Eine D√ºrre ist eine lange Trockenperiode." },
                    { question: "Was sind die Jahreszeiten?", answer: "fr√ºhling sommer herbst winter", explanation: "Das sind Fr√ºhling, Sommer, Herbst und Winter." },
                    { question: "Was ist die Klimazone, in der es immer warm ist und viel regnet?", answer: "tropen", explanation: "Das ist die tropische Klimazone." },
                    { question: "Was ist der Wind?", answer: "luftbewegung", explanation: "Wind ist bewegte Luft." }
                ],
                cities: [
                    { question: "Wie hei√üt die Hauptstadt von Frankreich?", answer: "paris", explanation: "Die Hauptstadt Frankreichs ist Paris." },
                    { question: "Wie hei√üt die Hauptstadt von Italien?", answer: "rom", explanation: "Die Hauptstadt Italiens ist Rom." },
                    { question: "Wie hei√üt die Hauptstadt von Spanien?", answer: "madrid", explanation: "Die Hauptstadt Spaniens ist Madrid." },
                    { question: "Wie hei√üt die Hauptstadt des Vereinigten K√∂nigreichs?", answer: "london", explanation: "Die Hauptstadt des Vereinigten K√∂nigreichs ist London." },
                    { question: "Wie hei√üt die Hauptstadt der USA?", answer: "washington", explanation: "Die Hauptstadt der USA ist Washington, D.C." },
                    { question: "Wie hei√üt die Hauptstadt von Japan?", answer: "tokio", explanation: "Die Hauptstadt Japans ist Tokio." }
                ]
            },
            history: {
                timeline: [
                    { question: "Wof√ºr steht 'v. Chr.'?", answer: "vor christus", explanation: "Es bedeutet 'vor Christus'." },
                    { question: "Wof√ºr steht 'n. Chr.'?", answer: "nach christus", explanation: "Es bedeutet 'nach Christus'." },
                    { question: "Was kam zuerst: Steinzeit oder R√∂merzeit?", answer: "steinzeit", explanation: "Die Steinzeit war lange vor der R√∂merzeit." },
                    { question: "Wie viele Jahre sind ein Jahrhundert?", answer: "100", explanation: "Ein Jahrhundert sind 100 Jahre." },
                    { question: "Wie viele Jahre sind ein Jahrtausend?", answer: "1000", explanation: "Ein Jahrtausend sind 1000 Jahre." },
                    { question: "In welchem Jahrhundert leben wir?", answer: "21", explanation: "Wir leben im 21. Jahrhundert." }
                ],
                egypt: [
                    { question: "Wie hie√ü der K√∂nig des Alten √Ñgyptens?", answer: "pharao", explanation: "Der K√∂nig hie√ü Pharao." },
                    { question: "Welcher Fluss war lebenswichtig f√ºr √Ñgypten?", answer: "nil", explanation: "Der Nil brachte Wasser und fruchtbaren Schlamm." },
                    { question: "Wie nennt man die gro√üen Bauwerke, in denen Pharaonen begraben wurden?", answer: "pyramiden", explanation: "Das sind die Pyramiden." },
                    { question: "Wie hei√üt die Schrift der alten √Ñgypter?", answer: "hieroglyphen", explanation: "Die Schrift hie√ü Hieroglyphen." },
                    { question: "Was ist eine Mumie?", answer: "toter k√∂rper", explanation: "Ein einbalsamierter und bandagierter Toter." },
                    { question: "Welches Tier war in √Ñgypten heilig und wurde oft als Gottheit verehrt?", answer: "katze", explanation: "Katzen galten als heilig." }
                ],
                greece: [
                    { question: "Woher kommt die Idee der Demokratie?", answer: "griechenland", explanation: "Die Demokratie entstand im antiken Griechenland (Athen)." },
                    { question: "Wie hie√üen die ber√ºhmten griechischen Stadtstaaten?", answer: "athen sparta", explanation: "Athen und Sparta waren bekannte Stadtstaaten." },
                    { question: "Welches gro√üe Bauwerk steht auf dem Berg in Athen?", answer: "parthenon", explanation: "Das Parthenon ist ein Tempel auf der Akropolis." },
                    { question: "Wer war ein ber√ºhmter griechischer Philosoph?", answer: "sokrates", explanation: "Sokrates, Platon, Aristoteles waren ber√ºhmte Philosophen." },
                    { question: "Wie nennt man die Geschichten √ºber G√∂tter und Helden in Griechenland?", answer: "mythologie", explanation: "Das ist die griechische Mythologie." },
                    { question: "Welche Wettk√§mpfe wurden im antiken Griechenland abgehalten?", answer: "olympische spiele", explanation: "Die Olympischen Spiele." }
                ],
                rome: [
                    { question: "Wie hei√üt der ber√ºhmte Anf√ºhrer, der √ºber die Alpen zog?", answer: "hannibal", explanation: "Hannibal war ein karthagischer Feldherr." },
                    { question: "Wie nennt man die r√∂mischen Soldaten?", answer: "legion√§re", explanation: "Sie hie√üen Legion√§re." },
                    { question: "Welches gro√üe Bauwerk diente in Rom f√ºr Gladiatorenk√§mpfe?", answer: "kolosseum", explanation: "Das Kolosseum war eine Arena." },
                    { question: "Wer war der erste r√∂mische Kaiser?", answer: "augustus", explanation: "Augustus war der erste r√∂mische Kaiser." },
                    { question: "Was ist Latein?", answer: "sprache", explanation: "Latein war die Sprache der R√∂mer." },
                    { question: "Was bauten die R√∂mer, um Wasser in die St√§dte zu leiten?", answer: "aqu√§dukte", explanation: "Sie bauten Aqu√§dukte." }
                ],
                medieval: [
                    { question: "Wer lebte auf einer Burg im Mittelalter?", answer: "ritter", explanation: "Ritter, F√ºrsten und ihre Familien lebten auf Burgen." },
                    { question: "Wie nannte man die Bauern im Mittelalter?", answer: "leibeigene", explanation: "Oft Leibeigene oder Untertanen." },
                    { question: "Was war im Mittelalter die wichtigste Kirche?", answer: "katholische kirche", explanation: "Die katholische Kirche." },
                    { question: "Wozu dienten Kl√∂ster im Mittelalter?", answer: "bildung", explanation: "Kl√∂ster waren Orte der Bildung, Gebets und der Arbeit." },
                    { question: "Was ist ein Wappen?", answer: "emblem", explanation: "Ein Wappen ist ein Erkennungszeichen f√ºr Familien oder Ritter." },
                    { question: "Nenne ein wichtiges Handwerk im Mittelalter.", answer: "schmied", explanation: "Schmied, B√§cker, Weber, Schuster waren wichtige Handwerke." }
                ],
                sources: [
                    { question: "Was ist eine schriftliche Quelle aus der Geschichte?", answer: "brief", explanation: "Briefe, B√ºcher, Urkunden sind schriftliche Quellen." },
                    { question: "Was ist eine m√ºndliche Quelle?", answer: "erz√§hlung", explanation: "Geschichten, Legenden, Augenzeugenberichte sind m√ºndliche Quellen." },
                    { question: "Was ist eine Sachquelle?", answer: "werkzeug", explanation: "Werkzeuge, Geb√§ude, Kleidung sind Sachquellen." },
                    { question: "Warum sind Quellen wichtig f√ºr die Geschichte?", answer: "beweise", explanation: "Sie sind Beweismittel, um die Vergangenheit zu erforschen." },
                    { question: "Was ist der Unterschied zwischen einer Quelle und einer Darstellung?", answer: "zeitlich", explanation: "Eine Quelle ist aus der Zeit, eine Darstellung ist √ºber die Zeit." },
                    { question: "Was ist eine Prim√§rquelle?", answer: "originaldokument", explanation: "Eine Prim√§rquelle ist ein Originaldokument oder Artefakt aus der untersuchten Zeit." }
                ]
            }
        };

        // Funktionen zur Ansichtsverwaltung
        function showHomeView(viewType) {
            document.getElementById('home-subjects-view').classList.add('hidden');
            document.getElementById('home-worksheets-view').classList.add('hidden');
            document.getElementById('subject-view').classList.add('hidden');
            document.getElementById('quiz-view').classList.add('hidden');

            document.getElementById('nav-subjects').classList.remove('active');
            document.getElementById('nav-worksheets').classList.remove('active');

            if (viewType === 'subjects') {
                document.getElementById('home-subjects-view').classList.remove('hidden');
                document.getElementById('nav-subjects').classList.add('active');
            } else if (viewType === 'worksheets') {
                document.getElementById('home-worksheets-view').classList.remove('hidden');
                document.getElementById('nav-worksheets').classList.add('active');
                generateWorksheetsList(); // Arbeitsbl√§tterliste nur bei Bedarf generieren
            }
            updateGlobalStats();
        }

        function openSubject(subjectId) {
            currentSubject = subjectId;
            document.getElementById('home-subjects-view').classList.add('hidden');
            document.getElementById('subject-view').classList.remove('hidden');
            
            const subjectData = subjects[subjectId];
            document.getElementById('subject-title').textContent = subjectData.name;
            document.getElementById('subject-description').textContent = subjectData.description;
            
            const topicsContainer = document.getElementById('topics-container');
            topicsContainer.innerHTML = '';
            subjectData.topics.forEach(topic => {
                const topicCard = document.createElement('div');
                topicCard.className = 'topic-card';
                topicCard.innerHTML = `
                    <h3>${topic.name}</h3>
                    <p>${topic.description}</p>
                    <button class="btn" onclick="startTopicQuiz('${subjectId}', '${topic.id}')">Quiz starten</button>
                `;
                topicsContainer.appendChild(topicCard);
            });
        }

        function goToSubject() {
            document.getElementById('quiz-view').classList.add('hidden');
            document.getElementById('subject-view').classList.remove('hidden');
            // reset quiz state
            resetQuiz();
        }

        function startTopicQuiz(subjectId, topicId) {
            currentSubject = subjectId; // Sicherstellen, dass currentSubject gesetzt ist
            currentTopic = topicId;
            document.getElementById('subject-view').classList.add('hidden');
            document.getElementById('quiz-view').classList.remove('hidden');
            document.getElementById('quiz-title').textContent = `${subjects[subjectId].name} - ${subjects[subjectId].topics.find(t => t.id === topicId).name} Quiz`;
            
            questionsForQuiz = questions[subjectId][topicId];
            if (!questionsForQuiz || questionsForQuiz.length === 0) {
                document.getElementById('question-text').textContent = "Keine Fragen f√ºr dieses Thema verf√ºgbar.";
                document.getElementById('answer-input').classList.add('hidden');
                document.getElementById('submit-btn').classList.add('hidden');
                document.getElementById('next-btn').classList.add('hidden');
                document.getElementById('start-btn').classList.add('hidden'); // Quiz starten Button ausblenden, wenn keine Fragen
                return;
            }

            // Mische die Fragen, damit sie nicht immer in der gleichen Reihenfolge kommen
            questionsForQuiz = shuffleArray(questionsForQuiz);
            questionIndex = 0;
            resetQuiz(); // Setzt Quiz-Statistiken zur√ºck und zeigt Start-Button
            document.getElementById('quiz-end-screen').classList.add('hidden'); // Ende-Bildschirm ausblenden
        }

        function startQuiz() {
            score = 0;
            streak = 0;
            totalQuestionsAttempted = 0;
            correctAnswersCount = 0;
            questionIndex = 0; // Fragen neu beginnen

            updateCurrentStats();
            document.getElementById('feedback').classList.remove('show', 'correct', 'incorrect');
            document.getElementById('feedback').textContent = '';
            document.getElementById('answer-input').value = '';
            document.getElementById('answer-input').classList.remove('hidden');
            document.getElementById('submit-btn').classList.remove('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('start-btn').classList.add('hidden'); // Start-Button ausblenden
            document.getElementById('quiz-end-screen').classList.add('hidden'); // Ende-Bildschirm ausblenden

            gameActive = true;
            startTimer();
            loadQuestion();
        }

        function loadQuestion() {
            if (questionIndex < questionsForQuiz.length) {
                currentQuestion = questionsForQuiz[questionIndex];
                document.getElementById('question-text').textContent = currentQuestion.question;
                document.getElementById('answer-input').value = '';
                document.getElementById('answer-input').focus();
                document.getElementById('submit-btn').classList.remove('hidden');
                document.getElementById('next-btn').classList.add('hidden');
                document.getElementById('feedback').classList.remove('show', 'correct', 'incorrect');
                document.getElementById('quiz-progress-text').textContent = `Frage ${questionIndex + 1} von ${questionsForQuiz.length}`;
            } else {
                endQuiz();
            }
        }

        function checkAnswer() {
            if (!gameActive) return;

            const userAnswer = document.getElementById('answer-input').value.trim().toLowerCase();
            const correctAnswer = currentQuestion.answer.toLowerCase();
            const feedbackElement = document.getElementById('feedback');

            totalQuestionsAttempted++;

            if (userAnswer === correctAnswer) {
                score += 10;
                streak++;
                correctAnswersCount++;
                feedbackElement.textContent = `Richtig! ${currentQuestion.explanation}`;
                feedbackElement.className = 'feedback correct show';
                playCelebration();
            } else {
                streak = 0; // Streak zur√ºcksetzen bei falscher Antwort
                feedbackElement.textContent = `Leider falsch. Die richtige Antwort ist: ${currentQuestion.answer}. ${currentQuestion.explanation}`;
                feedbackElement.className = 'feedback incorrect show';
            }
            updateCurrentStats();
            updateGlobalStats(); // Globale Statistiken sofort aktualisieren

            document.getElementById('submit-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.remove('hidden');
            document.getElementById('answer-input').classList.add('pulse');
            setTimeout(() => {
                document.getElementById('answer-input').classList.remove('pulse');
            }, 500);
        }

        function nextQuestion() {
            questionIndex++;
            document.getElementById('answer-input').value = ''; // Eingabefeld leeren
            if (questionIndex < questionsForQuiz.length) {
                loadQuestion();
            } else {
                endQuiz();
            }
        }

        function endQuiz() {
            gameActive = false;
            clearInterval(timer);
            document.getElementById('quiz-title').textContent = "Quiz beendet!";
            document.getElementById('question-container').classList.add('hidden');
            document.getElementById('answer-input').classList.add('hidden');
            document.getElementById('submit-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('quiz-progress-text').classList.add('hidden');
            document.getElementById('game-stats').classList.add('hidden'); // Spielstatistiken ausblenden

            document.getElementById('final-score').textContent = score;
            document.getElementById('final-correct-answers').textContent = correctAnswersCount;
            document.getElementById('final-total-questions').textContent = totalQuestionsAttempted;
            document.getElementById('quiz-end-screen').classList.remove('hidden');
        }

        function resetQuiz() {
            score = 0;
            streak = 0;
            timeLeft = 60;
            gameActive = false;
            clearInterval(timer);
            totalQuestionsAttempted = 0;
            correctAnswersCount = 0;
            questionIndex = 0;

            document.getElementById('current-score').textContent = '0';
            document.getElementById('current-streak').textContent = '0';
            document.getElementById('time-left').textContent = '60';
            document.getElementById('question-text').textContent = 'Bereit f√ºr deine erste Aufgabe?';
            document.getElementById('answer-input').value = '';
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback'; // Alle Klassen entfernen

            document.getElementById('answer-input').classList.remove('hidden');
            document.getElementById('submit-btn').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('start-btn').classList.remove('hidden'); // Start-Button anzeigen
            document.getElementById('quiz-end-screen').classList.add('hidden'); // Ende-Bildschirm ausblenden
            document.getElementById('question-container').classList.remove('hidden'); // Frage anzeigen
            document.getElementById('quiz-progress-text').classList.remove('hidden'); // Fortschritt anzeigen
            document.getElementById('game-stats').classList.remove('hidden'); // Spielstatistiken anzeigen
        }

        function startTimer() {
            clearInterval(timer); // Alten Timer l√∂schen, falls vorhanden
            timeLeft = 60; // Timer zur√ºcksetzen
            document.getElementById('time-left').textContent = timeLeft;
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('time-left').textContent = timeLeft;
                if (timeLeft <= 0) {
                    endQuiz();
                }
            }, 1000);
        }

        function updateCurrentStats() {
            document.getElementById('current-score').textContent = score;
            document.getElementById('current-streak').textContent = streak;
        }

        function updateGlobalStats() {
            // Update total score and streak
            totalScore += score;
            totalStreak = Math.max(totalStreak, streak); // Keep highest streak
            localStorage.setItem('totalScore', totalScore);
            localStorage.setItem('totalStreak', totalStreak);

            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('totalStreak').textContent = totalStreak;
        }

        function playCelebration() {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            celebration.textContent = 'üéâ';
            document.body.appendChild(celebration);
            setTimeout(() => {
                celebration.remove();
            }, 1000);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function generateWorksheetsList() {
            const container = document.getElementById('worksheets-list-container');
            container.innerHTML = ''; // Vorherige Eintr√§ge leeren
            availableWorksheets.forEach(worksheet => {
                const worksheetCard = document.createElement('div');
                worksheetCard.className = 'worksheet-card';
                worksheetCard.innerHTML = `
                    <div class="worksheet-icon">üìÑ</div>
                    <h3>${worksheet.title}</h3>
                    <p>${worksheet.description}</p>
                    <a href="${worksheet.fileName}" download="${worksheet.fileName}" class="btn">
                        Download PDF
                    </a>
                `;
                container.appendChild(worksheetCard);
            });
        }


        // --- Dark Mode / Light Mode Switcher ---
        const lightModeBtn = document.getElementById('light-mode-btn');
        const darkModeBtn = document.getElementById('dark-mode-btn');

        function enableDarkMode() {
            document.body.classList.add('dark-mode');
            localStorage.setItem('theme', 'dark');
            darkModeBtn.classList.add('active');
            lightModeBtn.classList.remove('active');
        }

        function enableLightMode() {
            document.body.classList.remove('dark-mode');
            localStorage.setItem('theme', 'light');
            lightModeBtn.classList.add('active');
            darkModeBtn.classList.remove('active');
        }

        // Check for saved theme preference or system preference on load
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                if (savedTheme === 'dark') {
                    enableDarkMode();
                } else {
                    enableLightMode();
                }
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                // If no saved preference, check system preference
                enableDarkMode();
            } else {
                enableLightMode(); // Default to light mode
            }

            lightModeBtn.addEventListener('click', enableLightMode);
            darkModeBtn.addEventListener('click', enableDarkMode);

            updateGlobalStats(); // Globale Statistiken beim Start laden
            showHomeView('subjects'); // Standardm√§√üig die F√§cher√ºbersicht anzeigen
        });

        // Event Listener f√ºr "Enter"-Taste im Antwortfeld
        document.getElementById('answer-input').addEventListener('keypress', function(event) {
            if (event.key === 'Enter' && gameActive) { // Nur reagieren, wenn Quiz aktiv ist
                if (!document.getElementById('submit-btn').classList.contains('hidden')) {
                    checkAnswer(); // Wenn "Pr√ºfen"-Button sichtbar, Antwort pr√ºfen
                } else if (!document.getElementById('next-btn').classList.contains('hidden')) {
                    nextQuestion(); // Wenn "N√§chste Frage"-Button sichtbar, n√§chste Frage laden
                }
                event.preventDefault(); // Standardverhalten der Enter-Taste unterbinden (z.B. Formular absenden)
            }
        });
    </script>
</body>
<style>
        /* Spezielles CSS nur f√ºr diesen Footer-Bereich */
        /* Beachte: Normalerweise geh√∂rt CSS in den <head>-Bereich, aber hier direkt f√ºr dich eingef√ºgt */

        footer {
            width: 100%;
            padding: 40px 20px; /* Mehr Padding f√ºr mehr Raum */
            margin-top: auto; /* Sorgt daf√ºr, dass der Footer am unteren Rand bleibt */
            text-align: center;
            font-size: 0.95em;
            color: #f0f0f0; /* Hellere Schriftfarbe f√ºr besseren Kontrast */
            background: linear-gradient(90deg, #34495e 0%, #2c3e50 100%); /* Dunklerer, markanterer Hintergrund */
            border-top: 5px solid #2980b9; /* Kr√§ftige obere Linie */
            box-shadow: 0 -5px 15px rgba(0,0,0,0.3); /* St√§rkerer Schatten */
            position: relative; /* F√ºr den "Back to Top" Button, falls wir den sp√§ter hinzuf√ºgen */
        }
        /* Dark Mode Anpassung f√ºr Footer (falls du sie separat steuern willst) */
        body.dark-mode footer {
            background: linear-gradient(90deg, #1c2833 0%, #0d0d0d 100%);
            border-top-color: #007bff;
            color: #e0e0e0;
        }
        body.light-mode footer {
             /* Sicherstellen, dass Light Mode auch definiert ist, falls du den Dark Mode nur f√ºr den Footer im Standard an hast */
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-top-color: #667eea;
            color: white;
        }


        .footer-content {
            display: flex;
            flex-direction: column; /* Standardm√§√üig untereinander auf kleinen Bildschirmen */
            align-items: center;
            max-width: 900px; /* An den Hauptinhalt anpassen */
            margin: 0 auto;
            gap: 15px; /* Mehr Abstand zwischen den Zeilen */
        }

        .footer-links {
            display: flex;
            gap: 25px; /* Abstand zwischen den Links */
            flex-wrap: wrap; /* Links umbrechen lassen auf kleinen Bildschirmen */
            justify-content: center;
        }

        .footer-links a {
            color: inherit; /* Farbe vom Footer erben */
            text-decoration: none;
            font-weight: bold; /* Links hervorheben */
            transition: color 0.3s ease, transform 0.2s ease;
            padding: 5px 10px; /* Etwas Padding f√ºr Klickfl√§che */
            border-radius: 5px;
        }

        .footer-links a:hover {
            color: #00bcd4; /* T√ºrkis als Hover-Farbe */
            transform: translateY(-2px); /* Leichter Schwebe-Effekt */
        }
        .dark-mode .footer-links a:hover {
            color: #79f2f2; /* Hellere T√ºrkis-Variante f√ºr Dark Mode */
        }
        .light-mode .footer-links a:hover {
            color: #ffeb3b; /* Gelb als Hover-Farbe im Light Mode */
        }


        /* Responsive Anpassung f√ºr Footer - auf gr√∂√üeren Bildschirmen nebeneinander */
        @media (min-width: 768px) {
            .footer-content {
                flex-direction: row; /* Nebeneinander auf gr√∂√üeren Bildschirmen */
                justify-content: space-between; /* Elemente verteilen */
                align-items: center;
            }
            .footer-links {
                justify-content: flex-end; /* Links nach rechts ausrichten */
            }
        }
    </style>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 Bohncity Schule. Alle Rechte vorbehalten.</p>
            <div class="footer-links">
                <a href="https://epiccity-real.github.io/page/impressum.html" target="_blank" rel="noopener noreferrer">Impressum</a>
                </div>
            </div>
    </footer>
</html>
