<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bohncity Schule - Klasse 5</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .bean-logo {
            font-size: 3rem;
            margin-bottom: 10px;
            display: inline-block;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: bold;
        }

        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .subject-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 5px solid;
        }

        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .subject-card.math { border-left-color: #3182ce; }
        .subject-card.german { border-left-color: #38a169; }
        .subject-card.english { border-left-color: #e53e3e; }
        .subject-card.science { border-left-color: #805ad5; }
        .subject-card.geography { border-left-color: #319795; }
        .subject-card.history { border-left-color: #d69e2e; }

        .subject-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .subject-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .subject-description {
            color: #718096;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .topic-view {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .back-btn {
            background: #718096;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-btn:hover {
            background: #4a5568;
        }

        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .topic-card {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .topic-card:hover {
            border-color: #667eea;
            background: #edf2f7;
            transform: translateY(-2px);
        }

        .quiz-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .question-card {
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            font-size: 1.2rem;
            line-height: 1.6;
        }

        .answer-input {
            width: 100%;
            max-width: 300px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1.1rem;
            margin: 20px 0;
            text-align: center;
        }

        .answer-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .feedback {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
        }

        .feedback.correct {
            background: #c6f6d5;
            color: #22543d;
            border: 2px solid #68d391;
        }

        .feedback.incorrect {
            background: #fed7d7;
            color: #742a2a;
            border: 2px solid #fc8181;
        }

        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            background: #f7fafc;
            padding: 15px;
            border-radius: 15px;
        }

        .game-stat {
            text-align: center;
        }

        .game-stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .game-stat-label {
            color: #718096;
            font-size: 0.9rem;
        }

        .hidden {
            display: none;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            z-index: 1000;
            animation: celebrate 1s ease-out;
        }

        @keyframes celebrate {
            0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); }
            50% { transform: translate(-50%, -50%) scale(1.2) rotate(180deg); }
            100% { transform: translate(-50%, -50%) scale(1) rotate(360deg); }
        }

        @media (max-width: 768px) {
            .subjects-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="bean-logo">ü´ò</div>
            <h1>Bohncity Schule</h1>
            <p>Klasse 5 - Interaktive Lernplattform</p>
            <div class="stats">
                <div class="stat-item">
                    <span>üèÜ</span>
                    <span>Punkte: <span id="totalScore">0</span></span>
                </div>
                <div class="stat-item">
                    <span>‚ö°</span>
                    <span>Streak: <span id="totalStreak">0</span></span>
                </div>
                <div class="stat-item">
                    <span>üìö</span>
                    <span>F√§cher: 6</span>
                </div>
            </div>
        </div>

        <!-- Hauptmen√º -->
        <div id="home-view">
            <div class="subjects-grid">
                <div class="subject-card math" onclick="openSubject('math')">
                    <div class="subject-icon">üî¢</div>
                    <div class="subject-title">Mathematik</div>
                    <div class="subject-description">Rechnen mit nat√ºrlichen Zahlen, Geometrie & Br√ºche</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card german" onclick="openSubject('german')">
                    <div class="subject-icon">üìö</div>
                    <div class="subject-title">Deutsch</div>
                    <div class="subject-description">Wortarten, Satzglieder & Rechtschreibung</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card english" onclick="openSubject('english')">
                    <div class="subject-icon">üá¨üáß</div>
                    <div class="subject-title">Englisch</div>
                    <div class="subject-description">Grundwortschatz & Simple Present</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card science" onclick="openSubject('science')">
                    <div class="subject-icon">üî¨</div>
                    <div class="subject-title">Natur & Technik</div>
                    <div class="subject-description">K√∂rper, Tiere & Stromkreise</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card geography" onclick="openSubject('geography')">
                    <div class="subject-icon">üåç</div>
                    <div class="subject-title">Geographie</div>
                    <div class="subject-description">Kontinente, Deutschland & Karten lesen</div>
                    <button class="btn">Starten</button>
                </div>
                
                <div class="subject-card history" onclick="openSubject('history')">
                    <div class="subject-icon">üìú</div>
                    <div class="subject-title">Geschichte</div>
                    <div class="subject-description">R√∂mer, √Ñgypter & Mittelalter</div>
                    <button class="btn">Starten</button>
                </div>
            </div>
        </div>

        <!-- Fach-Ansicht -->
        <div id="subject-view" class="hidden">
            <button class="back-btn" onclick="goHome()">
                ‚Üê Zur√ºck zur Startseite
            </button>
            <div class="topic-view">
                <h2 id="subject-title"></h2>
                <p id="subject-description"></p>
                <div class="topics-grid" id="topics-container"></div>
            </div>
        </div>

        <!-- Quiz-Ansicht -->
        <div id="quiz-view" class="hidden">
            <button class="back-btn" onclick="goToSubject()">
                ‚Üê Zur√ºck zu den Themen
            </button>
            <div class="quiz-container">
                <h2 id="quiz-title"></h2>
                <div class="game-stats">
                    <div class="game-stat">
                        <div class="game-stat-value" id="current-score">0</div>
                        <div class="game-stat-label">Punkte</div>
                    </div>
                    <div class="game-stat">
                        <div class="game-stat-value" id="current-streak">0</div>
                        <div class="game-stat-label">Streak</div>
                    </div>
                    <div class="game-stat">
                        <div class="game-stat-value" id="time-left">60</div>
                        <div class="game-stat-label">Zeit</div>
                    </div>
                </div>
                
                <div class="question-card" id="question-container">
                    <div id="question-text">Bereit f√ºr deine erste Aufgabe?</div>
                </div>
                
                <input type="text" class="answer-input" id="answer-input" placeholder="Deine Antwort...">
                
                <div class="feedback hidden" id="feedback"></div>
                
                <button class="btn" id="submit-btn" onclick="checkAnswer()">Antwort pr√ºfen</button>
                <button class="btn hidden" id="next-btn" onclick="nextQuestion()">N√§chste Frage</button>
                <button class="btn hidden" id="start-btn" onclick="startQuiz()">Quiz starten</button>
            </div>
        </div>
    </div>

    <script>
        let currentSubject = null;
        let currentTopic = null;
        let score = 0;
        let streak = 0;
        let totalScore = parseInt(localStorage.getItem('totalScore') || '0');
        let totalStreak = parseInt(localStorage.getItem('totalStreak') || '0');
        let timeLeft = 60;
        let gameActive = false;
        let currentQuestion = null;
        let timer = null;
        let totalQuestions = 0;
        let correctAnswers = 0;

        // F√§cher und Themen
        const subjects = {
            math: {
                name: 'Mathematik',
                icon: 'üî¢',
                description: 'Rechnen, Geometrie und logisches Denken',
                topics: [
                    { id: 'addition', name: 'Addition & Subtraktion', description: 'Grundrechenarten √ºben' },
                    { id: 'multiplication', name: 'Multiplikation & Division', description: 'Einmaleins und Teilen' },
                    { id: 'fractions', name: 'Br√ºche', description: 'Einf√ºhrung in Br√ºche' },
                    { id: 'geometry', name: 'Geometrie', description: 'Formen und Fl√§chen' },
                    { id: 'units', name: 'Ma√üeinheiten', description: 'L√§ngen, Gewichte, Zeit' },
                    { id: 'word_problems', name: 'Sachaufgaben', description: 'Mathematik im Alltag' }
                ]
            },
            german: {
                name: 'Deutsch',
                icon: 'üìö',
                description: 'Sprache, Rechtschreibung und Texte verstehen',
                topics: [
                    { id: 'word_types', name: 'Wortarten', description: 'Nomen, Verben, Adjektive' },
                    { id: 'sentence_parts', name: 'Satzglieder', description: 'Subjekt, Pr√§dikat, Objekt' },
                    { id: 'tenses', name: 'Zeitformen', description: 'Pr√§sens, Pr√§teritum, Perfekt' },
                    { id: 'spelling', name: 'Rechtschreibung', description: 'Richtig schreiben' },
                    { id: 'texts', name: 'Texte schreiben', description: 'Beschreibungen und Berichte' },
                    { id: 'reading', name: 'Lesen & Verstehen', description: 'Texte erfassen' }
                ]
            },
            english: {
                name: 'Englisch',
                icon: 'üá¨üáß',
                description: 'Grundlagen der englischen Sprache',
                topics: [
                    { id: 'vocabulary', name: 'Grundwortschatz', description: 'Familie, Schule, Freizeit' },
                    { id: 'simple_present', name: 'Simple Present', description: 'Gegenwart auf Englisch' },
                    { id: 'pronouns', name: 'Pronomen', description: 'I, you, he, she, it' },
                    { id: 'questions', name: 'Fragen stellen', description: 'What, where, when, why' },
                    { id: 'conversations', name: 'Gespr√§che', description: 'Begr√º√üung und Small Talk' },
                    { id: 'writing', name: 'Texte schreiben', description: 'Kurze Texte verfassen' }
                ]
            },
            science: {
                name: 'Natur & Technik',
                icon: 'üî¨',
                description: 'Forschen und die Welt verstehen',
                topics: [
                    { id: 'senses', name: 'Sinne', description: 'Sehen, H√∂ren, Riechen, Schmecken' },
                    { id: 'body', name: 'Menschlicher K√∂rper', description: 'Bewegung und Gesundheit' },
                    { id: 'animals', name: 'Tiere', description: 'Lebensr√§ume und Verhalten' },
                    { id: 'plants', name: 'Pflanzen', description: 'Wachstum und Photosynthese' },
                    { id: 'electricity', name: 'Strom', description: 'Stromkreise und Ger√§te' },
                    { id: 'environment', name: 'Umwelt', description: 'Nachhaltigkeit und Schutz' }
                ]
            },
            geography: {
                name: 'Geographie',
                icon: 'üåç',
                description: 'Die Welt entdecken und verstehen',
                topics: [
                    { id: 'directions', name: 'Himmelsrichtungen', description: 'Norden, S√ºden, Osten, Westen' },
                    { id: 'continents', name: 'Kontinente', description: 'Europa, Asien, Afrika...' },
                    { id: 'germany', name: 'Deutschland', description: 'Bundesl√§nder und Gebirge' },
                    { id: 'maps', name: 'Karten lesen', description: 'Orientierung und Ma√üstab' },
                    { id: 'climate', name: 'Klima', description: 'Wetter und Klimazonen' },
                    { id: 'cities', name: 'St√§dte & L√§nder', description: 'Hauptst√§dte Europas' }
                ]
            },
            history: {
                name: 'Geschichte',
                icon: 'üìú',
                description: 'Reise in die Vergangenheit',
                topics: [
                    { id: 'timeline', name: 'Zeitrechnung', description: 'v. Chr. und n. Chr.' },
                    { id: 'egypt', name: 'Altes √Ñgypten', description: 'Pharaonen und Pyramiden' },
                    { id: 'greece', name: 'Griechenland', description: 'Demokratie und G√∂tter' },
                    { id: 'rome', name: 'R√∂misches Reich', description: 'Gladiatoren und Legionen' },
                    { id: 'medieval', name: 'Mittelalter', description: 'Ritter und Burgen' },
                    { id: 'sources', name: 'Quellen', description: 'Wie erforscht man Geschichte?' }
                ]
            }
        };

        // Fragen f√ºr verschiedene Themen
        const questions = {
            math: {
                addition: [
                    { question: "Was ist 25 + 17?", answer: "42", explanation: "25 + 17 = 42" },
                    { question: "Was ist 84 - 29?", answer: "55", explanation: "84 - 29 = 55" },
                    { question: "Was ist 156 + 78?", answer: "234", explanation: "156 + 78 = 234" },
                    { question: "Was ist 200 - 85?", answer: "115", explanation: "200 - 85 = 115" }
                ],
                multiplication: [
                    { question: "Was ist 7 √ó 8?", answer: "56", explanation: "7 √ó 8 = 56" },
                    { question: "Was ist 9 √ó 6?", answer: "54", explanation: "9 √ó 6 = 54" },
                    { question: "Was ist 72 √∑ 8?", answer: "9", explanation: "72 √∑ 8 = 9" },
                    { question: "Was ist 45 √∑ 5?", answer: "9", explanation: "45 √∑ 5 = 9" }
                ]
            },
            german: {
                word_types: [
                    { question: "Welche Wortart ist 'Hund'?", answer: "nomen", explanation: "Hund ist ein Nomen (Hauptwort)" },
                    { question: "Welche Wortart ist 'laufen'?", answer: "verb", explanation: "Laufen ist ein Verb (Tunwort)" },
                    { question: "Welche Wortart ist 'sch√∂n'?", answer: "adjektiv", explanation: "Sch√∂n ist ein Adjektiv (Eigenschaftswort)" }
                ]
            },
            english: {
                vocabulary: [
                    { question: "Wie hei√üt 'Hund' auf Englisch?", answer: "dog", explanation: "Hund = dog" },
                    { question: "Wie hei√üt 'Katze' auf Englisch?", answer: "cat", explanation: "Katze = cat" },
                    { question: "Wie hei√üt 'Haus' auf Englisch?", answer: "house", explanation: "Haus = house" }
                ]
            },
            science: {
                senses: [
                    { question: "Mit welchem Organ riechen wir?", answer: "nase", explanation: "Wir riechen mit der Nase" },
                    { question: "Wie viele Sinne hat der Mensch?", answer: "5", explanation: "Sehen, H√∂ren, Riechen, Schmecken, Tasten" }
                ]
            },
            geography: {
                directions: [
                    { question: "Wie hei√üt die Himmelsrichtung zwischen Nord und Ost?", answer: "nordost", explanation: "Zwischen Nord und Ost liegt Nordost" },
                    { question: "Welche Himmelsrichtung ist das Gegenteil von Norden?", answer: "s√ºden", explanation: "Das Gegenteil von Norden ist S√ºden" }
                ]
            },
            history: {
                egypt: [
                    { question: "Wie hie√üen die Herrscher im alten √Ñgypten?", answer: "pharaonen", explanation: "Die Herrscher √Ñgyptens waren die Pharaonen" },
                    { question: "Welcher Fluss flie√üt durch √Ñgypten?", answer: "nil", explanation: "Der Nil ist der Fluss √Ñgyptens" }
                ]
            }
        };

        // Initialisierung
        document.addEventListener('DOMContentLoaded', function() {
            updateTotalStats();
            document.getElementById('answer-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
        });

        function updateTotalStats() {
            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('totalStreak').textContent = totalStreak;
        }

        function openSubject(subjectId) {
            currentSubject = subjectId;
            const subject = subjects[subjectId];
            
            document.getElementById('home-view').classList.add('hidden');
            document.getElementById('subject-view').classList.remove('hidden');
            
            document.getElementById('subject-title').textContent = subject.name + ' - Klasse 5';
            document.getElementById('subject-description').textContent = subject.description;
            
            const topicsContainer = document.getElementById('topics-container');
            topicsContainer.innerHTML = '';
            
            subject.topics.forEach(topic => {
                const topicDiv = document.createElement('div');
                topicDiv.className = 'topic-card';
                topicDiv.onclick = () => startTopic(topic.id);
                topicDiv.innerHTML = `
                    <h3>${topic.name}</h3>
                    <p>${topic.description}</p>
                `;
                topicsContainer.appendChild(topicDiv);
            });
        }

        function startTopic(topicId) {
            currentTopic = topicId;
            
            document.getElementById('subject-view').classList.add('hidden');
            document.getElementById('quiz-view').classList.remove('hidden');
            
            const subject = subjects[currentSubject];
            const topic = subject.topics.find(t => t.id === topicId);
            
            document.getElementById('quiz-title').textContent = topic.name;
            document.getElementById('start-btn').classList.remove('hidden');
            document.getElementById('submit-btn').classList.add('hidden');
            
            resetGame();
        }

        function resetGame() {
            score = 0;
            streak = 0;
            timeLeft = 60;
            totalQuestions = 0;
            correctAnswers = 0;
            gameActive = false;
            
            updateGameStats();
            
            document.getElementById('question-text').textContent = 'Bereit f√ºr deine erste Aufgabe?';
            document.getElementById('answer-input').value = '';
            document.getElementById('feedback').classList.add('hidden');
            
            if (timer) clearInterval(timer);
        }

        function startQuiz() {
            gameActive = true;
            document.getElementById('start-btn').classList.add('hidden');
            document.getElementById('submit-btn').classList.remove('hidden');
            
            // Timer starten
            timer = setInterval(() => {
                timeLeft--;
                updateGameStats();
                
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
            
            generateQuestion();
        }

        function generateQuestion() {
            const topicQuestions = questions[currentSubject]?.[currentTopic];
            
            if (!topicQuestions || topicQuestions.length === 0) {
                // Fallback: Einfache Mathe-Fragen generieren
                if (currentSubject === 'math') {
                    const num1 = Math.floor(Math.random() * 50) + 1;
                    const num2 = Math.floor(Math.random() * 50) + 1;
                    const operations = ['+', '-', '√ó'];
                    const op = operations[Math.floor(Math.random() * operations.length)];
                    
                    let answer;
                    let questionText;
                    
                    switch(op) {
                        case '+':
                            answer = num1 + num2;
                            questionText = `Was ist ${num1} + ${num2}?`;
                            break;
                        case '-':
                            answer = Math.abs(num1 - num2);
                            questionText = `Was ist ${Math.max(num1, num2)} - ${Math.min(num1, num2)}?`;
                            break;
                        case '√ó':
                            const smallNum1 = Math.floor(Math.random() * 10) + 1;
                            const smallNum2 = Math.floor(Math.random() * 10) + 1;
                            answer = smallNum1 * smallNum2;
                            questionText = `Was ist ${smallNum1} √ó ${smallNum2}?`;
                            break;
                    }
                    
                    currentQuestion = {
                        question: questionText,
                        answer: answer.toString(),
                        explanation: `${questionText.replace('Was ist ', '')} = ${answer}`
                    };
                } else {
                    // Andere F√§cher: Einfache Beispielfragen
                    const fallbackQuestions = [
                        { question: "Das ist eine Beispielfrage f√ºr " + subjects[currentSubject].name, answer: "beispiel", explanation: "Das ist eine Beispielantwort" }
                    ];
                    currentQuestion = fallbackQuestions[0];
                }
            } else {
                currentQuestion = topicQuestions[Math.floor(Math.random() * topicQuestions.length)];
            }
            
            document.getElementById('question-text').textContent = currentQuestion.question;
            document.getElementById('answer-input').value = '';
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('answer-input').focus();
        }

        function checkAnswer() {
            if (!gameActive) return;
            
            const userAnswer = document.getElementById('answer-input').value.trim().toLowerCase();
            const correctAnswer = currentQuestion.answer.toLowerCase();
            
            totalQuestions++;
            
            if (userAnswer === correctAnswer) {
                // Richtige Antwort
                correctAnswers++;
                score += 10;
                streak++;
                totalScore += 10;
                
                if (streak > totalStreak) {
                    totalStreak = streak;
                }
                
                showFeedback(true, currentQuestion.explanation);
                showCelebration('üéâ');
                
                // Speichere Fortschritt
                localStorage.setItem('totalScore', totalScore.toString());
                localStorage.setItem('totalStreak', totalStreak.toString());
                
            } else {
                // Falsche Antwort
                streak = 0;
                showFeedback(false, currentQuestion.explanation);
                showCelebration('‚ùå');
            }
            
            updateGameStats();
            updateTotalStats();
            
            // N√§chste Frage nach kurzer Pause
            setTimeout(() => {
                generateQuestion();
            }, 2000);
        }

        function showFeedback(isCorrect, explanation) {
            const feedback = document.getElementById('feedback');
            feedback.classList.remove('hidden', 'correct', 'incorrect');
            
            if (isCorrect) {
                feedback.classList.add('correct');
                feedback.innerHTML = `<strong>Richtig!</strong> ${explanation}`;
            } else {
                feedback.classList.add('incorrect');
                feedback.innerHTML = `<strong>Falsch!</strong> ${explanation}`;
            }
        }

        function showCelebration(emoji) {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            celebration.textContent = emoji;
            document.body.appendChild(celebration);
            
            setTimeout(() => {
                document.body.removeChild(celebration);
            }, 1000);
        }

        function updateGameStats() {
            document.getElementById('current-score').textContent = score;
            document.getElementById('current-streak').textContent = streak;
            document.getElementById('time-left').textContent = timeLeft;
            
            // Farbe f√ºr Timer √§ndern
            const timeElement = document.getElementById('time-left');
            if (timeLeft <= 10) {
                timeElement.style.color = '#e53e3e';
                timeElement.classList.add('pulse');
            } else if (timeLeft <= 30) {
                timeElement.style.color = '#d69e2e';
            } else {
                timeElement.style.color = '#667eea';
                timeElement.classList.remove('pulse');
            }
        }

        function endGame() {
            gameActive = false;
            clearInterval(timer);
            
            const accuracy = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0;
            
            document.getElementById('question-text').innerHTML = `
                <h3>üéØ Quiz beendet!</h3>
                <p><strong>Deine Ergebnisse:</strong></p>
                <p>Punkte: ${score}</p>
                <p>Richtige Antworten: ${correctAnswers} von ${totalQuestions}</p>
                <p>Genauigkeit: ${accuracy}%</p>
                <p>L√§ngste Serie: ${streak}</p>
                <br>
                <p>Gro√üartig gemacht! üåü</p>
            `;
            
            document.getElementById('answer-input').style.display = 'none';
            document.getElementById('submit-btn').classList.add('hidden');
            document.getElementById('start-btn').classList.remove('hidden');
            document.getElementById('start-btn').textContent = 'Nochmal spielen';
            
            // Erfolgs-Animation
            if (accuracy >= 80) {
                showCelebration('üèÜ');
            } else if (accuracy >= 60) {
                showCelebration('üëç');
            }
        }

        function nextQuestion() {
            generateQuestion();
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('submit-btn').classList.remove('hidden');
        }

        function goHome() {
            document.getElementById('subject-view').classList.add('hidden');
            document.getElementById('quiz-view').classList.add('hidden');
            document.getElementById('home-view').classList.remove('hidden');
            
            if (timer) clearInterval(timer);
            currentSubject = null;
            currentTopic = null;
        }

        function goToSubject() {
            document.getElementById('quiz-view').classList.add('hidden');
            document.getElementById('subject-view').classList.remove('hidden');
            
            if (timer) clearInterval(timer);
            currentTopic = null;
            
            // Eingabefeld wieder anzeigen
            document.getElementById('answer-input').style.display = 'block';
        }

        // Zus√§tzliche Funktionen f√ºr bessere Benutzerfreundlichkeit
        function addBonusQuestions() {
            // Erweiterte Fragendatenbank
            questions.math.fractions = [
                { question: "Was ist 1/2 + 1/4?", answer: "3/4", explanation: "1/2 + 1/4 = 2/4 + 1/4 = 3/4" },
                { question: "Was ist gr√∂√üer: 1/3 oder 1/4?", answer: "1/3", explanation: "1/3 ist gr√∂√üer als 1/4" }
            ];
            
            questions.german.spelling = [
                { question: "Schreibe richtig: 'Das ist ein sh√∂ner Tag'", answer: "das ist ein sch√∂ner tag", explanation: "Richtig: Das ist ein sch√∂ner Tag" },
                { question: "Schreibe richtig: 'Ich gehe ins Kino'", answer: "ich gehe ins kino", explanation: "Richtig: Ich gehe ins Kino" }
            ];
            
            questions.english.simple_present = [
                { question: "He ___ to school every day. (go)", answer: "goes", explanation: "He goes to school every day." },
                { question: "She ___ her homework. (do)", answer: "does", explanation: "She does her homework." }
            ];
            
            questions.science.body = [
                { question: "Wie viele Knochen hat ein erwachsener Mensch etwa?", answer: "206", explanation: "Ein erwachsener Mensch hat etwa 206 Knochen" },
                { question: "Welches Organ pumpt das Blut durch den K√∂rper?", answer: "herz", explanation: "Das Herz pumpt das Blut durch den K√∂rper" }
            ];
            
            questions.geography.germany = [
                { question: "Wie hei√üt die Hauptstadt von Deutschland?", answer: "berlin", explanation: "Berlin ist die Hauptstadt von Deutschland" },
                { question: "Welches ist das gr√∂√üte Bundesland?", answer: "bayern", explanation: "Bayern ist das gr√∂√üte Bundesland" }
            ];
            
            questions.history.rome = [
                { question: "Wie hie√üen die r√∂mischen Soldaten?", answer: "legion√§re", explanation: "Die r√∂mischen Soldaten hie√üen Legion√§re" },
                { question: "Welche Stadt war das Zentrum des R√∂mischen Reiches?", answer: "rom", explanation: "Rom war das Zentrum des R√∂mischen Reiches" }
            ];
        }

        // Bonus-Fragen hinzuf√ºgen
        addBonusQuestions();

        // Keyboard-Shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (document.getElementById('quiz-view').classList.contains('hidden') === false) {
                    goToSubject();
                } else if (document.getElementById('subject-view').classList.contains('hidden') === false) {
                    goHome();
                }
            }
        });

        // Motivierende Nachrichten
        function getMotivationalMessage(streak) {
            if (streak >= 10) return "Unglaublich! Du bist ein wahrer Mathe-Meister! üåü";
            if (streak >= 5) return "Fantastisch! Du bist auf einem super Weg! üöÄ";
            if (streak >= 3) return "Toll gemacht! Du bist richtig gut! üëç";
            return "Weiter so! Du schaffst das! üí™";
        }

        // Schwierigkeitsgrade
        function adjustDifficulty() {
            if (streak >= 5) {
                // Schwierigere Fragen f√ºr fortgeschrittene Spieler
                return 'hard';
            } else if (streak >= 3) {
                return 'medium';
            }
            return 'easy';
        }

        // Lokale Bestenliste
        function updateLeaderboard() {
            let leaderboard = JSON.parse(localStorage.getItem('leaderboard') || '[]');
            
            const entry = {
                subject: subjects[currentSubject].name,
                topic: subjects[currentSubject].topics.find(t => t.id === currentTopic)?.name,
                score: score,
                accuracy: totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0,
                date: new Date().toLocaleDateString('de-DE')
            };
            
            leaderboard.push(entry);
            leaderboard.sort((a, b) => b.score - a.score);
            leaderboard = leaderboard.slice(0, 10); // Top 10
            
            localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
        }

        // Fortschritts-Tracking
        function trackProgress() {
            let progress = JSON.parse(localStorage.getItem('progress') || '{}');
            
            if (!progress[currentSubject]) {
                progress[currentSubject] = {};
            }
            
            if (!progress[currentSubject][currentTopic]) {
                progress[currentSubject][currentTopic] = {
                    attempts: 0,
                    bestScore: 0,
                    totalQuestions: 0,
                    correctAnswers: 0
                };
            }
            
            const topicProgress = progress[currentSubject][currentTopic];
            topicProgress.attempts++;
            topicProgress.bestScore = Math.max(topicProgress.bestScore, score);
            topicProgress.totalQuestions += totalQuestions;
            topicProgress.correctAnswers += correctAnswers;
            
            localStorage.setItem('progress', JSON.stringify(progress));
        }

        // Erfolge und Abzeichen
        function checkAchievements() {
            let achievements = JSON.parse(localStorage.getItem('achievements') || '[]');
            
            // Erste Schritte
            if (totalQuestions >= 1 && !achievements.includes('first_question')) {
                achievements.push('first_question');
                showAchievement('üéØ', 'Erste Frage beantwortet!');
            }
            
            // Streak-Meister
            if (streak >= 5 && !achievements.includes('streak_master')) {
                achievements.push('streak_master');
                showAchievement('üî•', 'Streak-Meister!');
            }
            
            // Punkte-Sammler
            if (totalScore >= 100 && !achievements.includes('point_collector')) {
                achievements.push('point_collector');
                showAchievement('üíé', 'Punkte-Sammler!');
            }
            
            localStorage.setItem('achievements', JSON.stringify(achievements));
        }

        function showAchievement(emoji, text) {
            const achievement = document.createElement('div');
            achievement.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                padding: 15px 20px;
                border-radius: 15px;
                font-size: 1.1rem;
                font-weight: bold;
                z-index: 1000;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: slideIn 0.5s ease-out;
            `;
            achievement.innerHTML = `${emoji} ${text}`;
            document.body.appendChild(achievement);
            
            setTimeout(() => {
                achievement.style.animation = 'slideOut 0.5s ease-in';
                setTimeout(() => {
                    if (document.body.contains(achievement)) {
                        document.body.removeChild(achievement);
                    }
                }, 500);
            }, 3000);
        }

        // CSS-Animationen f√ºr Achievements
        const achievementCSS = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        
        const style = document.createElement('style');
        style.textContent = achievementCSS;
        document.head.appendChild(style);

        // √úberpr√ºfe Erfolge nach jeder Antwort
        function enhancedCheckAnswer() {
            checkAnswer();
            checkAchievements();
            
            if (!gameActive) {
                updateLeaderboard();
                trackProgress();
            }
        }

        // Ersetze die urspr√ºngliche checkAnswer Funktion
        const originalCheckAnswer = checkAnswer;
        checkAnswer = enhancedCheckAnswer;

        console.log('ü´ò Bohncity Schule geladen! Viel Spa√ü beim Lernen!');
    </script>
</body>
</html>
